!function a(o,s,u){function p(t,e){if(!s[t]){if(!o[t]){var r="function"==typeof require&&require;if(!e&&r)return r(t,!0);if(c)return c(t,!0);var i=new Error("Cannot find module '"+t+"'");throw i.code="MODULE_NOT_FOUND",i}var n=s[t]={exports:{}};o[t][0].call(n.exports,function(e){return p(o[t][1][e]||e)},n,n.exports,a,o,s,u)}return s[t].exports}for(var c="function"==typeof require&&require,e=0;e<u.length;e++)p(u[e]);return p}({1:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./veryengine/veryEngine"),n=(a.prototype.createScene=function(){this._engine&&this._engine.dispose(),this._engine=new BABYLON.Engine(this._canvas,!0),i.VeryEngine.Engine=this._engine;var t=this._engine;window.addEventListener("resize",function(){t.resize()}),this._scene=new BABYLON.Scene(this._engine),i.VeryEngine.Scene=this._scene;var e=new BABYLON.ArcRotateCamera("MainCamera",0,0,10,new BABYLON.Vector3(0,0,0),this._scene);return e.setPosition(new BABYLON.Vector3(20,200,400)),e.attachControl(this._canvas,!0),e.lowerBetaLimit=.1,e.upperBetaLimit=Math.PI/2*.99,e.lowerRadiusLimit=150,t.displayLoadingUI(),BABYLON.SceneLoader.Append("./scene/","scene.babylon",this._scene,function(e){t.hideLoadingUI()}),(new i.VeryEngine).init(hot1.getData(),projectName),this._scene.onBeforeRenderObservable.add(function(){i.Time._sum()}),this},a.prototype.animate=function(){var e=this;return this._engine.runRenderLoop(function(){e._canvas.width!==e._canvas.clientWidth&&e._engine.resize(),e._scene&&e._scene.render(),e._showFps&&e.updateFpsPos()}),this},a.prototype.toggleDebug=function(){if(this._engine){var e=this._engine.scenes[0];e.debugLayer.isVisible()?e.debugLayer.hide():e.debugLayer.show({embedMode:!0})}return this},a.prototype.updateFpsPos=function(){this._fps&&(this._fps.style.right=document.body.clientWidth-(this._table.clientWidth+this._canvas.clientWidth)+"px",this._fps.innerHTML=this._engine.getFps().toFixed()+" fps")},a);function a(e,t){this._showFps=!0,this._canvas=e,i.VeryEngine.Canvas=this._canvas,this._fps=t,this._table=document.getElementById("VeryTable")}r.default=n},{"./veryengine/veryEngine":81}],2:[function(e,t,r){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(r,"__esModule",{value:!0});var n,a,o,s=i(e("./game"));document.getElementById("runButton").addEventListener("click",function(){n&&n.createScene().animate()}),document.getElementById("debugButton").addEventListener("click",function(){n&&n.toggleDebug()}),a=document.getElementById("renderCanvas"),o=document.getElementById("fpsLabel"),null!==a&&null!==o&&(n=new s.default(a,o)).createScene().animate()},{"./game":1}],3:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../enum"),n=(Object.defineProperty(a.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"objectID",{get:function(){return this._objectID},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"actionID",{get:function(){return this._actionID},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"Type",{get:function(){return i.ActionType.Normal},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"everyFrame",{get:function(){return this._erveryFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"SequenceState",{get:function(){return this._sequenceState},set:function(e){this._sequenceState=e},enumerable:!0,configurable:!0}),a.prototype.setEveryFrame=function(e){this._erveryFrame=e},a.prototype.setActionID=function(e,t){this._objectID=e,this._actionID=t},a.prototype.paraParser=function(e){return!0},a.prototype.action=function(e,t){this._enabled=e,this._erveryFrame=t,this._enabled&&(this.active(),this._erveryFrame||this.onUpdate())},a.prototype.update=function(){this._enabled&&this._erveryFrame&&this.onUpdate()},a.prototype.onUpdate=function(){},a.prototype.pause=function(){this._sequenceState=i.SequenceActionState.Pause},a.prototype.resume=function(){this._sequenceState=i.SequenceActionState.Running},a.prototype.stop=function(){this._sequenceState=i.SequenceActionState.Initial},a.prototype.finish=function(){this._sequenceState=i.SequenceActionState.Initial,this.enabled=!1},a);function a(){this._enabled=!0,this._projectName="",this._objectID="",this._actionID="",this._erveryFrame=!1,this.isSequence=!1,this._sequenceState=i.SequenceActionState.Initial}r.VE_ActionBehaviour=n},{"../enum":17}],4:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../html"),s=e("../state"),u=e("../manager"),i=(a.addAction=function(e){for(var t=e.ID.split("|"),r=0;r<t.length;r++){var i=t[r].trim().toLowerCase();this._actionDics[i]?n.ShowError.showError("响应初始化错误，响应ID重复，当前响应ID："+i+"，请为当前响应重新分配响应ID！"):this._actionDics[i]=e}},a.hasAction=function(e){return e=e.toLowerCase(),!!this._actionDics[e]},a.createAction=function(e){return e=e.toLowerCase(),Object.create(this._actionDics[e])},a.remove=function(e){e=e.toLowerCase(),delete this._actionDics[e]},a.findAction=function(e,t){if(e.isCreatedAction(t))return e.getAction(t);var r=t.split(s.StateConst.STATE_SEPARATOR);if(2!==r.length)return null;var i=u.VE_Manager.objects(e.projectName),n=r[0].trim(),a=r[1].trim();if(i.isCreated(n)){var o=i.getVeryObject(n);return o.isCreatedAction(a)?o.getAction(a):null}return null},a._actionDics={},a);function a(){}r.VE_Actions=i},{"../html":39,"../manager":49,"../state":60}],5:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../enum"),n=e("../html"),a=e("../utility"),o=e("./assignmentTypeJudge"),s=(Object.defineProperty(u.prototype,"state",{get:function(){return this._state},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"leftType",{get:function(){return this._leftType},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rightType",{get:function(){return this._rightType},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"leftVariable",{get:function(){return this._leftVariable},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"rightVariable",{get:function(){return this._leftVariable},enumerable:!0,configurable:!0}),u.prototype.setPos=function(e){this._pos=e},u.prototype.setLeftVariable=function(e){this._leftType=i.AssignType.Variable,this._leftVariable=e},u.prototype.setLeftTemplate=function(e){this._leftType=i.AssignType.Template,this._leftTemplate=e},u.prototype.setLeftTemplateVar=function(e,t){this._leftType=i.AssignType.TemplateVariable,this._leftTemplate=e,this._leftVarID=t},u.prototype.setRightVariable=function(e){this._rightType=i.AssignType.Variable,this._rightVariable=e},u.prototype.setRightTemplate=function(e){this._rightType=i.AssignType.Template,this._rightTemplate=e},u.prototype.setRightNull=function(){this._rightType=i.AssignType.Template,this._rightTemplate=null},u.prototype.setRightTemplateVariable=function(e,t){this._rightType=i.AssignType.TemplateVariable,this._rightTemplate=e,this._rightVarID=t},u.prototype.setRightConst=function(e){this._rightType=i.AssignType.Const,this._rightConstStr=e},u.prototype.setRightConstValue=function(e){this._rightType=i.AssignType.Const,this._rightConstValue=e},u.prototype.finish=function(){},u.prototype.assign=function(){if(this._leftType===i.AssignType.Variable)this.rightAssignment();else if(this._leftType===i.AssignType.Template)null==this._rightTemplate?null!==this._leftTemplate&&this._leftTemplate.unload():this._leftTemplate=this._rightTemplate;else{if(null===this._leftTemplate.templateInstance)return void n.ShowError.showError("位置："+this._pos+"，项目名："+this.state.Fsm.projectName+"，对象名："+this.state.Fsm.objectID+"，状态名："+this.state.Fsm.fsmID+"，赋值响应："+this._totalStr+"，错误：左侧模板变量未实例化，"+this._leftTemplate.templateVarID);if(this._leftTemplate.templateInstance.isCreatedExpression(this._leftVarID))return void n.ShowError.showError("位置："+this._pos+"，项目名："+this.state.Fsm.projectName+"，对象名："+this.state.Fsm.objectID+"，状态名："+this.state.Fsm.fsmID+"，赋值响应："+this._totalStr+"，错误：左侧变量不能为“公式”，"+this._rightTemplate.templateVarID);if(this._leftTemplate.templateInstance.isCreatedVariable(this._leftVarID))this._leftVariable=this._leftTemplate.templateInstance.getVariable(this._leftVarID),this.rightAssignment();else{if(!this._leftTemplate.templateInstance.isCreatedFsm(this._leftVarID))return void n.ShowError.showError("位置："+this._pos+"，项目名："+this.state.Fsm.projectName+"，对象名："+this.state.Fsm.objectID+"，状态名："+this.state.Fsm.fsmID+"，赋值响应："+this._totalStr+"，错误：左侧无法被查找到，"+this._rightTemplate.templateVarID);this._leftVariable=this._leftTemplate.templateInstance.getFsm(this._leftVarID).fsmVar,this.rightAssignment()}}},u.prototype.rightAssignment=function(){if(this._rightType===i.AssignType.Variable)this._leftVariable.setValue(this._rightVariable.getValue());else if(this._rightType===i.AssignType.Const)if(null===this._rightConstValue){var e=new a.ErrorInfo;if(this._rightConstValue=this._leftVariable.initValue(this._rightConstStr,e),!e.isRight)return void n.ShowError.showError("位置："+this._pos+"，项目名："+this.state.Fsm.projectName+"，对象名："+this.state.Fsm.objectID+"，状态名："+this.state.Fsm.fsmID+"，赋值响应："+this._totalStr+"，错误：右侧常量转化错误，"+this._rightConstStr);this._leftVariable.setValue(this._rightConstValue)}else this._leftVariable.setValue(this._rightConstValue);else{if(null==this._rightTemplate.templateInstance)return void n.ShowError.showError("位置："+this._pos+"，项目名："+this.state.Fsm.projectName+"，对象名："+this.state.Fsm.objectID+"，状态名："+this.state.Fsm.fsmID+"，赋值响应："+this._totalStr+"，错误：右侧模板变量未实例化，"+this._rightTemplate.templateVarID);if(this._rightTemplate.templateInstance.isCreatedExpression(this._rightVarID)){var t=this._rightTemplate.templateInstance.getExpression(this._rightVarID);if(!o.VE_AssignmentTypeJudge.allowExpression(this._leftVariable,t))return void n.ShowError.showError("位置："+this._pos+"，项目名："+this.state.Fsm.projectName+"，对象名："+this.state.Fsm.objectID+"，状态名："+this.state.Fsm.fsmID+"，赋值响应："+this._totalStr+"，错误：左侧和右侧数据格式不匹配，不能完成赋值，"+this._rightTemplate.templateVarID);this._leftVariable.setValue(t.evaluate())}else if(this._rightTemplate.templateInstance.isCreatedVariable(this._rightVarID)){var r=this._rightTemplate.templateInstance.getVariable(this._rightVarID);if(!o.VE_AssignmentTypeJudge.allow(this._leftVariable,r))return void n.ShowError.showError("位置："+this._pos+"，项目名："+this.state.Fsm.projectName+"，对象名："+this.state.Fsm.objectID+"，状态名："+this.state.Fsm.fsmID+"，赋值响应："+this._totalStr+"，错误：左侧和右侧数据格式不匹配，不能完成赋值，"+this._rightTemplate.templateVarID);this._leftVariable.setValue(r.getValue())}else{if(!this._rightTemplate.templateInstance.isCreatedFsm(this._rightVarID))return void n.ShowError.showError("位置："+this._pos+"，项目名："+this.state.Fsm.projectName+"，对象名："+this.state.Fsm.objectID+"，状态名："+this.state.Fsm.fsmID+"，赋值响应："+this._totalStr+"，错误：无法获取右侧变量，不能完成赋值，"+this._rightTemplate.templateVarID);if(r=this._rightTemplate.templateInstance.getFsm(this._rightVarID).fsmVar,!o.VE_AssignmentTypeJudge.allow(this._leftVariable,r))return void n.ShowError.showError("位置："+this._pos+"，项目名："+this.state.Fsm.projectName+"，对象名："+this.state.Fsm.objectID+"，状态名："+this.state.Fsm.fsmID+"，赋值响应："+this._totalStr+"，错误：左侧和右侧数据格式不匹配，不能完成赋值，"+this._rightTemplate.templateVarID);this._leftVariable.setValue(r.getValue())}}},u);function u(e,t){this._totalStr="",this._leftType=i.AssignType.Variable,this._rightType=i.AssignType.Variable,this._leftVariable=null,this._leftTemplate=null,this._leftVarID="",this._rightConstStr="",this._rightConstValue=null,this._rightVariable=null,this._rightTemplate=null,this._rightVarID="",this._pos="",this._state=e,this._totalStr=t}r.VE_Assignment=s},{"../enum":17,"../html":39,"../utility":73,"./assignmentTypeJudge":6}],6:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.allow=function(e,t){return e.varType===t.varType},n.allowExpression=function(e,t){return e.varType===t.expType},n);function n(){}r.VE_AssignmentTypeJudge=i},{}],7:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./actionBehaviour")),i(e("./assignment")),i(e("./actions")),i(e("./sequenceActions"))},{"./actionBehaviour":3,"./actions":4,"./assignment":5,"./sequenceActions":8}],8:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../enum"),n=(Object.defineProperty(a.prototype,"sequenceState",{get:function(){return this._sequenceState},enumerable:!0,configurable:!0}),a);function a(){this._sequenceState=i.SequenceActionState.Initial}r.VE_SequenceActions=n},{"../enum":17}],9:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./fsmData"),n=(Object.defineProperty(a.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"objectID",{get:function(){return this._objectID},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"templateID",{get:function(){return this._templateID},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isTemplate",{get:function(){return this._isTemplate},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"id",{get:function(){return this._isTemplate?this._templateID:this._objectID},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"triggerCount",{get:function(){return this._triggerIDs.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"actionCount",{get:function(){return this._actionIDs.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"fsmCount",{get:function(){return this._fsmIDs.length},enumerable:!0,configurable:!0}),a.prototype.isCreatedFsm=function(e){return!!this._fsmDic[e]},a.prototype.createFsm=function(e,t){this._fsmIDs.push(e),this._fsmDic[e]=new i.VE_FsmData(e,this),this._fsmPosDic[e]=t},a.prototype.getFsmData=function(e){return this._fsmDic[e]},a.prototype.getFsmPos=function(e){return this._fsmPosDic[e]},a.prototype.hasFsmIndex=function(e){return 0<=e&&e<this._fsmIDs.length},a.prototype.getFsmID=function(e){return this._fsmIDs[e]},a.prototype.isCreatedTrigger=function(e){return!!this._triggerDic[e]},a.prototype.addTrigger=function(e,t,r){this._triggerIDs.push(e),this._triggerDic[e]=t,this._triggerPosDic[e]=r},a.prototype.getTrigger=function(e){return this._triggerDic[e]},a.prototype.getTriggerPos=function(e){return this._triggerPosDic[e]},a.prototype.hasTriggerIndex=function(e){return 0<=e&&e<this._triggerIDs.length},a.prototype.getTriggerID=function(e){return this._triggerIDs[e]},a.prototype.getTriggerPara=function(e){return this._triggerDic[e]},a.prototype.isCreatedAction=function(e){return!!this._actionDic[e]},a.prototype.addAction=function(e,t,r,i){this._actionIDs.push(e),this._actionDic[e]=t,this._actionInitValue[e]=r,this._actionPosDic[e]=i},a.prototype.getActionPara=function(e){return this._actionDic[e]},a.prototype.getActionPos=function(e){return this._actionPosDic[e]},a.prototype.getActionInitVal=function(e){return this._actionInitValue[e]},a.prototype.hasActionIndex=function(e){return 0<=e&&e<this._actionIDs.length},a.prototype.getActionID=function(e){return this._actionIDs[e]},a.prototype.clear=function(){this._fsmIDs=[],this._fsmDic={},this._triggerIDs=[],this._triggerDic={},this._actionIDs=[],this._actionDic={},this._actionInitValue={}},a);function a(e,t,r){this._projectName="",this._objectID="",this._templateID="",this._isTemplate=!1,this._fsmIDs=[],this._fsmDic={},this._fsmPosDic={},this._triggerIDs=[],this._triggerDic={},this._triggerPosDic={},this._actionIDs=[],this._actionDic={},this._actionInitValue={},this._actionPosDic={},this._projectName=e,(this._isTemplate=r)?this._templateID=t:this._objectID=t}r.VE_DataSource=n},{"./fsmData":10}],10:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n.prototype,"dataSource",{get:function(){return this._dataSource},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fsmID",{get:function(){return this._fsmID},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fsmType",{get:function(){return this._fsmType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"initialValStr",{get:function(){return this._initialValStr},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"count",{get:function(){return this._states.length},enumerable:!0,configurable:!0}),n.prototype.initFsm=function(e,t){this._fsmType=e,this._initialValStr=t},n.prototype.addState=function(e){this._states.push(e)},n.prototype.getStateData=function(e){return this._states[e]},n);function n(e,t){this._fsmType="",this._initialValStr="defalut",this._states=[],this._dataSource=t,this._fsmID=e}r.VE_FsmData=i},{}],11:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./variableData")),i(e("./fsmData")),i(e("./stateActionData")),i(e("./stateTriggerData")),i(e("./stateData")),i(e("./dataSource"))},{"./dataSource":9,"./fsmData":10,"./stateActionData":12,"./stateData":13,"./stateTriggerData":14,"./variableData":15}],12:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=e("../enum"),i=(n.prototype.setNormalAction=function(e,t,r,i){void 0===t&&(t="false"),void 0===r&&(r="false"),void 0===i&&(i="false"),this.actionID=e,this.enabled=t,this.everyFrame=r,this.isSequence=i,this.type=a.StateActionType.Action},n.prototype.setAssignmentAction=function(e,t,r){this.totalString=e,this.varID=t,this.varValue=r,this.type=a.StateActionType.Assignment},n);function n(e,t,r,i,n){void 0===t&&(t="false"),void 0===r&&(r="false"),void 0===i&&(i="false"),void 0===n&&(n=a.StateActionType.Action),this.totalString="",this.varID="",this.varValue="",this.actionID=e,this.enabled=t,this.everyFrame=r,this.isSequence=i,this.type=n}r.VE_StateActionData=i},{"../enum":17}],13:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../state"),i=(Object.defineProperty(a.prototype,"fsmData",{get:function(){return this._fsmData},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ValStr",{get:function(){return this._valStr},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isInitialValue",{get:function(){return this._isInitialValue},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"stateIndex",{get:function(){return this._stateIndex},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isSequence",{get:function(){return this._isSequence},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"triggerCount",{get:function(){return this._triggers.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"actionCount",{get:function(){return this._actions.length},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"associatedStateCount",{get:function(){return this._associatedStates.length},enumerable:!0,configurable:!0}),a.prototype.hasTrigger=function(e){return 0<=e&&e<this._triggers.length},a.prototype.addTrigger=function(e,t){this._triggers.push(e),this._triggersPos.push(t)},a.prototype.getTrigger=function(e){return this._triggers[e]},a.prototype.getTriggerPos=function(e){return this._triggersPos[e]},a.prototype.hasAction=function(e){return 0<=e&&e<this._actions.length},a.prototype.addAction=function(e,t){this._actions.push(e),this._actionsPos.push(t)},a.prototype.getAction=function(e){return this._actions[e]},a.prototype.getActionPos=function(e){return this._actionsPos[e]},a.prototype.hasAssociatedState=function(e){return 0<=e&&e<this._associatedStates.length},a.prototype.addAssociatedState=function(e,t){this._associatedStates.push(e),this._associatedStatesPos.push(t)},a.prototype.getAssociatedState=function(e){return this._associatedStates[e]},a.prototype.getAssociatedStatePos=function(e){return this._associatedStatesPos[e]},a.prototype.setSequence=function(){this._isSequence=!0},a);function a(e,t,r,i){void 0===i&&(i=n.StateConst.STATE_INDEX),this._stateIndex=n.StateConst.STATE_INDEX,this.logicalExp="",this.rowIndex=-1,this._triggers=[],this._triggersPos=[],this._actions=[],this._actionsPos=[],this._associatedStates=[],this._associatedStatesPos=[],this._isSequence=!1,this._fsmData=e,this._valStr=t,this._isInitialValue=r,this._stateIndex=i}r.VE_StateData=i},{"../state":60}],14:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n,"Empty",{get:function(){return new n("")},enumerable:!0,configurable:!0}),n);function n(e){this.triggerID=e,this.logicalSwitch="",this.logicalExp=""}r.VE_StateTriggerData=i},{}],15:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"count",{get:function(){return this._variableIDs.length},enumerable:!0,configurable:!0}),n.prototype.isCreatedVariable=function(e){return!!this._varDics[e]},n.prototype.addVariable=function(e,t,r){this._varDics[e]=t,this._variableIDs.push(e),this._varPosDic[e]=r},n.prototype.getVariableID=function(e){return 0<=e&&e<this._variableIDs.length?this._variableIDs[e]:""},n.prototype.getVariableParas=function(e){return this._varDics[e]},n.prototype.getPos=function(e){return this._varPosDic[e]},n.prototype.clear=function(){this._variableIDs=[],this._varDics={}},n);function n(e){this._projectName="",this._variableIDs=[],this._varDics={},this._varPosDic={},this._projectName=e}r.VE_VariableData=i},{}],16:[function(e,t,r){"use strict";var i,n,a,o,s,u,p,c;Object.defineProperty(r,"__esModule",{value:!0}),(i=r.ActionType||(r.ActionType={}))[i.Normal=0]="Normal",i[i.Animation=1]="Animation",(n=r.SequenceActionState||(r.SequenceActionState={}))[n.Initial=0]="Initial",n[n.Prepared=1]="Prepared",n[n.Running=2]="Running",n[n.Pause=3]="Pause",(a=r.StateActionType||(r.StateActionType={}))[a.Action=0]="Action",a[a.Assignment=1]="Assignment",(o=r.AssignType||(r.AssignType={}))[o.Variable=0]="Variable",o[o.Template=1]="Template",o[o.TemplateVariable=2]="TemplateVariable",o[o.Const=3]="Const",(s=r.AssignmentType||(r.AssignmentType={}))[s.Const=0]="Const",s[s.Variable=1]="Variable",s[s.Expression=2]="Expression",(u=r.AssociatedFsmType||(r.AssociatedFsmType={}))[u.Object=0]="Object",u[u.Template=1]="Template",(p=r.VariableScope||(r.VariableScope={}))[p.Local=0]="Local",p[p.Fsm=1]="Fsm",p[p.Global=2]="Global",p[p.Scene=3]="Scene",(c=r.Severity||(r.Severity={}))[c.Warning=0]="Warning",c[c.Error=1]="Error"},{}],17:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(e("./enumTypes"))},{"./enumTypes":16}],18:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.prototype.getValue=function(){return this._value},n.prototype.getLine=function(){return this._line},n.prototype.getPos=function(){return this._pos},n.prototype.isDigit=function(){return/\d/.test(this._value)},n.prototype.isLetter=function(){return/[a-zA-Z]/.test(this._value)},n.prototype.isWhiteSpace=function(){return" "===this._value},n.prototype.isNewLine=function(){return"\n"===this._value},n.prototype.isEndOfInput=function(){return"\0"===this._value},n.prototype.is=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0;r<e.length;r++)if(e[r]===this._value&&"\0"!==e[r])return!0;return!1},n.prototype.toString=function(){return this._value},n);function n(e,t,r){this._value="",this._line=0,this._pos=0,this._value=e,this._line=t,this._pos=r}r.ExpChar=i},{}],19:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./scope"),n=e("./positions"),a=e("./expressionParsing"),o=e("../enum"),s=e("../html"),u=(p.init=function(){this._scope=i.Scope.Create()},p.isCreated=function(e){return!!this._scope.isCreated(e)||!!this._expVariable[e]},p.isCreatedVariable=function(e){return!!this._scope.isCreated(e)},p.isCreatedExpression=function(e){return!!this._expVariable[e]},p.createVariable=function(e,t,r){return this.errors=[],this.isCreated(e)?(this.errors.push(n.ParseError.Error(new n.NameLocation(e),"变量："+e+"，类型："+t+"，该变量已创建，请勿重复创建！")),!1):(this._scope.setVariable(e,t,r),!0)},p.createExpression=function(e,t){if(this.errors=[],this.isCreated(e))return this.errors.push(n.ParseError.Error(new n.NameLocation(e),"表达式名："+e+"，表达式："+t+"，该表达式已定义，请勿重复定义！")),!1;var r=a.VE_ExpressionParsing.parsing(e,t,this._scope,this._projectName,"","",o.VariableScope.Scene);if(0<a.VE_ExpressionParsing.errors.length){for(var i=0;i<a.VE_ExpressionParsing.errors.length;i++)this.errors.push(a.VE_ExpressionParsing.errors[i]);return!1}return this._expVariable[e]=r,!0},p.getValue=function(e){return this.isCreated(e)?this.isCreatedVariable(e)?this._scope.find(e).getValue():this._expVariable[e].evaluate():null},p.getExpression=function(e){return this._expVariable[e]?this._expVariable[e]:null},p.getVariable=function(e){return this.isCreatedVariable(e)?this._scope.find(e):null},p.printError=function(){if(0<this.errors.length)for(var e=0;e<this.errors.length;e++)console.log(this.errors[e].toString()),s.ShowError.showError(this.errors[e].toString())},p._expVariable={},p.errors=[],p._projectName="",p._objectID="",p);function p(){}(r.ExpManager=u).init()},{"../enum":17,"../html":39,"./expressionParsing":21,"./positions":27,"./scope":28}],20:[function(e,t,r){"use strict";var i;Object.defineProperty(r,"__esModule",{value:!0}),(i=r.ExpressionType||(r.ExpressionType={}))[i.ID=0]="ID",i[i.SPECIAL_ID=1]="SPECIAL_ID",i[i.KEYWORD=2]="KEYWORD",i[i.STRING=3]="STRING",i[i.NUMBER=4]="NUMBER",i[i.BOOL=5]="BOOL",i[i.OPERATOR=6]="OPERATOR",i[i.INTEGER=7]="INTEGER",i[i.FLOAT=8]="FLOAT",i[i.DOUBLE=9]="DOUBLE",i[i.EOI=10]="EOI"},{}],21:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var s=e("./tokenizer"),f=e("./expressions"),g=e("./expressionEnum"),n=e("./functionExpression"),a=e("./functions"),d=e("./variableExpression"),y=e("../enum"),m=e("./veryExpressions"),E=e("../manager"),i=(o.init=function(){this._bracketPair["("]=")",this._bracketPair["["]="]",this._bracketPair["{"]="}",this._bracketPair["（"]="）",this._bracketPair["【"]="】"},o.parsing=function(e,t,r,i,n,a,o){return this._scope=r,this._projectName=i,this._objectID=n,this._fsmID=a,this._varScope=o,this._tokenizer=new s.Tokenizer(t),this.errors=[],this.parse()},o.parse=function(){var e=this.buildExpression();return this._tokenizer.current().isEnd()||(this._tokenizer.addError(this._tokenizer.current(),"未定义字符："+this._tokenizer.current().getSource()+"！"),this._tokenizer.consume()),this.errors=this._tokenizer.getProblemCollector(),e},o.buildExpression=function(){var e=this.relationalExp();if(this._tokenizer.current().isOperator("&&")){this._tokenizer.consume();var t=this.buildExpression();return this.reOrder(e,t,f.BinaryOperator.Add)}return this._tokenizer.current().isOperator("||")?(this._tokenizer.consume(),t=this.buildExpression(),this.reOrder(e,t,f.BinaryOperator.Or)):e},o.relationalExp=function(){var e=this.algebraExp();if(this._tokenizer.current().isOperator("<")){this._tokenizer.consume();var t=this.relationalExp();return this.reOrder(e,t,f.BinaryOperator.LT)}return this._tokenizer.current().isOperator("<=")?(this._tokenizer.consume(),t=this.relationalExp(),this.reOrder(e,t,f.BinaryOperator.LT_EQ)):this._tokenizer.current().isOperator("==")?(this._tokenizer.consume(),t=this.relationalExp(),this.reOrder(e,t,f.BinaryOperator.EQ)):this._tokenizer.current().isOperator(">=")?(this._tokenizer.consume(),t=this.relationalExp(),this.reOrder(e,t,f.BinaryOperator.GT_EQ)):this._tokenizer.current().isOperator(">")?(this._tokenizer.consume(),t=this.relationalExp(),this.reOrder(e,t,f.BinaryOperator.GT)):this._tokenizer.current().isOperator("!=")?(this._tokenizer.consume(),t=this.relationalExp(),this.reOrder(e,t,f.BinaryOperator.NEQ)):e},o.algebraExp=function(){var e=this.productExp();if(this._tokenizer.current().isOperator("+")){this._tokenizer.consume();var t=this.algebraExp();return this.reOrder(e,t,f.BinaryOperator.Add)}return this._tokenizer.current().isOperator("-")?(this._tokenizer.consume(),t=this.algebraExp(),this.reOrder(e,t,f.BinaryOperator.Subtract)):e},o.productExp=function(){var e=this.exponentExp();if(this._tokenizer.current().isOperator("*")){this._tokenizer.consume();var t=this.productExp();return this.reOrder(e,t,f.BinaryOperator.Multiply)}return this._tokenizer.current().isOperator("/")?(this._tokenizer.consume(),t=this.productExp(),this.reOrder(e,t,f.BinaryOperator.Divide)):this._tokenizer.current().isOperator("%")?(this._tokenizer.consume(),t=this.productExp(),this.reOrder(e,t,f.BinaryOperator.Modulo)):e},o.exponentExp=function(){var e=this.atomExp();return(this._tokenizer.current().isOperator("!")||this._tokenizer.current().isOperator("！"))&&(e=new f.BinaryExpression(e,e,f.BinaryOperator.Not)),e},o.atomExp=function(){if(this._tokenizer.current().isOperator("-"))return this._tokenizer.consume(),(r=new f.BinaryExpression(new f.ConstantExpression(0,"number"),this.atomExp(),f.BinaryOperator.Subtract)).setSeal(),r;if(this._tokenizer.current().isOperator("!")&&(this._tokenizer.next().isIdentifier()||this._tokenizer.next().isKeyword()||this._tokenizer.next().isStartBracket())){this._tokenizer.consume();var e=this.atomExp();return"bool"!==e.expType?(this._tokenizer.addError(this._tokenizer.current(),"取非运算(!)后应跟着bool值类型！"),f.ConstantExpression.Empty()):new f.BinaryExpression(e,e,f.BinaryOperator.Not)}if(this._tokenizer.current().isOperator("+")&&this._tokenizer.next().isStartBracket()&&this._tokenizer.consume(),this._tokenizer.current().isOperator("+")&&this._tokenizer.next().isConstant()&&this._tokenizer.consume(),this._tokenizer.current().isOperator("+")&&this._tokenizer.next().isIdentifier()&&this._tokenizer.consume(),this._tokenizer.current().isOperator("*")&&this._tokenizer.next().isIdentifier()){this._tokenizer.consume();var t="*"+this._tokenizer.current().getContents();return null!==(s=m.VE_Expressions.getParseExpression(this._projectName,this._objectID,t,this._varScope))?(this._tokenizer.consume(),s):(null===m.VE_Expressions.getTemplateExpression(this._projectName,this._objectID,t,this._varScope)?this._tokenizer.addError(this._tokenizer.current(),"VeryVar变量名："+t+"，该VeryVar变量未定义，无法在系统中查找到，请检查！"):this._tokenizer.addError(this._tokenizer.current(),"VeryVar变量名："+t+"，公式中不支持模板变量，请检查！"),this._tokenizer.consume(),f.ConstantExpression.Empty())}if(this._tokenizer.current().isStartBracket()){var r,i=this._bracketPair[this._tokenizer.consume().getTrigger()];return"BinaryExpression"===(r=this.buildExpression()).className&&r.setSeal(),this.expectTrigger(g.ExpressionType.OPERATOR,i),r}if(this._tokenizer.current().isConstant()){var n=void 0,a="string";return a=this._tokenizer.current().isBool()?(n="true"===this._tokenizer.current().getContents().toLowerCase(),"bool"):this._tokenizer.current().isNumber()?(n=parseFloat(this._tokenizer.current().getContents()),"number"):(n=this._tokenizer.current().getContents(),"string"),this._tokenizer.consume(),new f.ConstantExpression(n,a)}if(this._tokenizer.current().isIdentifier()){if(this._tokenizer.next().isStartBracket()){var o=this._bracketPair[this._tokenizer.next().getTrigger()];return this.functionCall(o)}var s,u=void 0,p=this._tokenizer.current(),c=this._tokenizer.consume().getContents();return c.endsWith(".")&&this._tokenizer.current().isOperator("*")&&this._tokenizer.next().isIdentifier()?(this._tokenizer.consume(),t=c+"*"+this._tokenizer.current().getContents(),null!==(s=m.VE_Expressions.getParseExpression(this._projectName,this._objectID,t,this._varScope))?(this._tokenizer.consume(),s):(null===m.VE_Expressions.getTemplateExpression(this._projectName,this._objectID,t,this._varScope)?this._tokenizer.addError(p,"VeryVar变量名："+t+"，该VeryVar变量未定义，无法在系统中查找到，请检查！"):this._tokenizer.addError(this._tokenizer.current(),"VeryVar变量名："+t+"，公式中不支持模板变量，请检查！"),this._tokenizer.consume(),f.ConstantExpression.Empty())):null===(u=this._scope.find(c))?(this._tokenizer.addError(p,"变量名："+c+"，该变量在变量作用域中未定义，也未定义该表达式，无法识别！另外，赋值响应右侧如果是公式，不允许引用模板变量！"),f.ConstantExpression.Empty()):new d.VariableExpression(u)}if(this._tokenizer.current().isKeyword()){if("this"!==this._tokenizer.current().getContents().toLowerCase().trim())return"null"===this._tokenizer.current().getContents().toLowerCase().trim()||"none"===this._tokenizer.current().getContents().toLowerCase().trim()?(this._tokenizer.consume(),new f.VeryTemplateExpression):(this._tokenizer.addError(this._tokenizer.current(),"关键字："+this._tokenizer.current().getContents()+"，该关键字暂无定义，请勿使用！"),this._tokenizer.consume(),f.ConstantExpression.Empty());if(this._varScope===y.VariableScope.Fsm&&""!==this._fsmID){var l=E.VE_Manager.objects(this._projectName);if(null!==l){var h=l.getVeryObject(this._objectID);if(null!=h){var _=h.getFsm(this._fsmID);if(null!=_)return this._tokenizer.consume(),new f.VeryVarExpression(_.fsmVar)}}}return this._tokenizer.addError(this._tokenizer.current(),"关键字：this，该关键字只能使用与状态定义中的触发启动条件和状态逻辑表达式，此处超出使用范围，请检查！"),this._tokenizer.consume(),f.ConstantExpression.Empty()}return this._tokenizer.current().isSpecialIdentifier()?this._tokenizer.addError(this._tokenizer.current(),"特殊ID："+this._tokenizer.current().getSource()+"，暂时未定义，请勿使用！"):this._tokenizer.addError(this._tokenizer.current(),"检测到无效字符："+this._tokenizer.current().getSource()+"，请检查！"),this._tokenizer.consume(),f.ConstantExpression.Empty()},o.reOrder=function(e,t,r){if("BinaryExpression"===t.className){var i=t;if(!i.isSealed()&&i.getPriority()===i.getPriorityOp(r))return this.replaceLeft(i,e,r),t}return new f.BinaryExpression(e,t,r)},o.replaceLeft=function(e,t,r){if("BinaryExpression"===e.getLeftExp().className){var i=e.getLeftExp();if(!i.isSealed()&&i.getPriority()===i.getPriorityOp(r))return void this.replaceLeft(i,t,r)}e.setLeftExp(new f.BinaryExpression(t,e.getLeftExp(),r))},o.functionCall=function(e){var t=new n.FunctionExpression,r=this._tokenizer.consume();if(!a.CustomFunctions.hasFunction(r.getContents()))return this._tokenizer.addError(r,"未定义函数："+r.getContents()+"！"),f.ConstantExpression.Empty();var i=a.CustomFunctions.createFunction(r.getContents());for(t.setFunction(i),this._tokenizer.consume();!this._tokenizer.current().isOperator(e)&&!this._tokenizer.current().isEnd();)0!==t.paraCount()&&this.expectTrigger(g.ExpressionType.OPERATOR,","),t.addPara(this.buildExpression());return this.expectTrigger(g.ExpressionType.OPERATOR,e),t.evaluate(),t.paraCount()>i.parameterNumber()&&0<=i.parameterNumber()?(this._tokenizer.addError(r,"函数参数不一致，当前函数："+r.getContents()+"，规定参数个数Max："+i.parameterNumber()+"，当前参数个数："+t.paraCount()+"，请检查！"),f.ConstantExpression.Empty()):t},o.expectTrigger=function(e,t){this._tokenizer.current().matches(e,t)?this._tokenizer.consume():this._tokenizer.addError(this._tokenizer.current(),"期望获得："+t+"，当前值为："+this._tokenizer.current().getTrigger()+"，请检查！")},o.getProjectCollector=function(){return this._tokenizer.getProblemCollector()},o._bracketPair={},o.errors=[],o._projectName="",o._objectID="",o._fsmID="",o._varScope=y.VariableScope.Local,o);function o(){}(r.VE_ExpressionParsing=i).init()},{"../enum":17,"../manager":49,"./expressionEnum":20,"./expressions":22,"./functionExpression":24,"./functions":25,"./tokenizer":31,"./variableExpression":33,"./veryExpressions":34}],22:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../utility/dictionary"),n=e("../template"),a=(Object.defineProperty(o.prototype,"expType",{get:function(){return"bool"},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"className",{get:function(){return"TrueExpression"},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"value",{get:function(){return!0},enumerable:!0,configurable:!0}),o.prototype.evaluate=function(){return!0},o.prototype.clone=function(){return new o},o.prototype.toString=function(){return"true"},o);function o(){}r.TrueExpression=a;var s,u,p=(Object.defineProperty(c.prototype,"expType",{get:function(){return this._expType},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"className",{get:function(){return"ConstantExpression"},enumerable:!0,configurable:!0}),c.prototype.evaluate=function(){return this._value},c.prototype.clone=function(){return new c(this._value,this._expType)},c.Empty=function(){return new c(null,"string")},c.prototype.isEmpty=function(){return"string"===this._expType&&null===this._value},c.prototype.toString=function(){return null!==this._value?this._value.toString():"null"},c);function c(e,t){this._expType="string",this._value=e,this._expType=t}r.ConstantExpression=p,(u=s=r.BinaryOperator||(r.BinaryOperator={})).Add="+",u.Subtract="-",u.Multiply="*",u.Divide="/",u.Modulo="%",u.Power="^",u.LT="<",u.LT_EQ="<=",u.EQ="=",u.GT_EQ=">=",u.GT=">",u.NEQ="!=",u.And="&&",u.Or="||",u.Not="!";var l=(Object.defineProperty(h.prototype,"expType",{get:function(){return this._expType},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"className",{get:function(){return"BinaryExpression"},enumerable:!0,configurable:!0}),h.init=function(){this._opDic["+"]=s.Add,this._opDic["-"]=s.Subtract,this._opDic["*"]=s.Multiply,this._opDic["/"]=s.Divide,this._opDic["%"]=s.Modulo,this._opDic["**"]=s.Power,this._opDic["^"]=s.Power,this._opDic["<"]=s.LT,this._opDic["<="]=s.LT_EQ,this._opDic["=="]=s.EQ,this._opDic[">="]=s.GT_EQ,this._opDic[">"]=s.GT,this._opDic["!="]=s.NEQ,this._opDic["&&"]=s.And,this._opDic["||"]=s.Or,this._opDic["!"]=s.Not,this._opDic["！"]=s.Not,this._priority.Add(s.Not,2),this._priority.Add(s.Power,3),this._priority.Add(s.Multiply,4),this._priority.Add(s.Divide,4),this._priority.Add(s.Modulo,4),this._priority.Add(s.Add,5),this._priority.Add(s.Subtract,5),this._priority.Add(s.LT,6),this._priority.Add(s.LT_EQ,6),this._priority.Add(s.EQ,6),this._priority.Add(s.GT_EQ,6),this._priority.Add(s.GT,6),this._priority.Add(s.NEQ,6),this._priority.Add(s.And,7),this._priority.Add(s.Or,7)},h.prototype.resultAutoType=function(e,t,r){return r===s.Add?"string"===e.expType||"string"===t.expType?"string":"bool"===e.expType||"bool"===t.expType?"null":"number"===e.expType||"number"===t.expType?"number":"vector3"===e.expType||"vector3"===t.expType?"vector3":"vector2"===e.expType||"vector2"===t.expType?"vector2":"null":r===s.Divide||r===s.Multiply||r===s.Modulo||r===s.Power||r===s.Subtract?"string"===e.expType||"string"===t.expType||"bool"===e.expType||"bool"===e.expType?"null":"vector3"===e.expType&&"vector3"===t.expType&&r===s.Subtract?"vector3":"vector2"===e.expType&&"vector2"===t.expType&&r===s.Subtract?"vector2":"number"===e.expType&&"vector3"===t.expType&&r===s.Multiply||"vector3"===e.expType&&"number"===t.expType&&r==s.Multiply?"vector3":"number"===e.expType&&"vector2"===t.expType&&r===s.Multiply||"vector2"===e.expType&&"number"===t.expType&&r==s.Multiply?"vector2":"vector3"===e.expType&&"number"===t.expType&&r===s.Divide?"vector3":"vector2"===e.expType&&"number"===t.expType&&r===s.Divide?"vector2":"number"===e.expType||"number"===t.expType?"number":"null":r===s.LT||r===s.LT_EQ||r===s.GT_EQ||r===s.GT?"string"===e.expType||"string"===t.expType||"bool"===e.expType||"bool"===t.expType?"null":"bool":r===s.NEQ||r===s.EQ?t.expType!==e.expType?"null":"bool":r===s.Not?"bool"!==t.expType?"null":"bool":"string"},h.prototype.setLeftExp=function(e){this._left=e},h.prototype.setRightExp=function(e){this._right=e},h.prototype.getOp=function(){return this._op},h.prototype.getLeftExp=function(){return this._left},h.prototype.getRightExp=function(){return this._right},h.prototype.isSealed=function(){return this._isSealed},h.prototype.setSeal=function(){this._isSealed=!0},h.prototype.toString=function(){return"("+this._left.toString()+" "+this._op.toString()+" "+this._right.toString()+")"},h.prototype.clone=function(){return new h(this._left.clone(),this._right.clone(),this._op)},h.prototype.evaluate=function(){if("null"===this._expType)return null;"FunctionExpression"===this._left.className&&this._left.evaluate(),"FunctionExpression"===this._right.className&&this._right.evaluate(),this._expType=this.resultAutoType(this._left,this._right,this._op);var e=this._left.evaluate(),t=this._right.evaluate();if(null===e||null===t)return null;if(this._op===s.Add)return"string"===this._expType?e.toString()+t.toString():"number"===this._expType?e+t:"vector3"===this._expType?e.add(t):"vector2"===this._expType?e.add(t):null;if(this._op===s.Subtract)return"number"===this._expType?e-t:"vector3"===this._expType?e.subtract(t):"vector2"===this._expType?e.subtract(t):null;if(this._op===s.Multiply){if("number"===this._expType)return e*t;if("vector3"===this._expType)return"number"==typeof e?t.multiplyByFloats(e,e,e):"number"==typeof t?e.multiplyByFloats(t,t,t):null;if("vector2"===this._expType)return"number"==typeof e?t.multiplyByFloats(e,e):"number"==typeof t?e.multiplyByFloats(t,t):null}else{if(this._op!==s.Divide){if(this._op===s.Modulo)return"number"==typeof e&&"number"==typeof t?e%t:null;if(this._op===s.Power)return"number"==typeof e&&"number"==typeof t?Math.pow(e,t):null;if(this._op!==s.And)return this._op!==s.Or?this._op===s.LT?e<t:this._op===s.LT_EQ?e<=t:this._op===s.GT_EQ?t<=e:this._op===s.GT?t<e:this._op===s.EQ?e===t:this._op===s.NEQ?e!==t:this._op===s.Not?!this.getBoolean(t):!this.getBoolean(e):(r=this.getBoolean(e),i=this.getBoolean(t),r||i);var r=this.getBoolean(e),i=this.getBoolean(t);return r&&i}if("number"===this._expType)return e/t;if("vector3"===this._expType)return"number"==typeof t?new BABYLON.Vector3(e.x/t,e.y/t,e.z/t):null;if("vector2"===this._expType)return"number"==typeof t?new BABYLON.Vector2(e.x/t,e.y/t):null}},h.prototype.getBoolean=function(e){return"number"==typeof e?0!==e:"string"==typeof e?""!==e:"boolean"==typeof e&&e},h.prototype.getPriority=function(){var e=h._priority.GetValue(this._op);return null===e?100:e},h.prototype.getPriorityOp=function(e){var t=h._priority.GetValue(e);return null===t?100:t},h._opDic={},h._priority=new i.Dictionary,h);function h(e,t,r){this._expType="",this.isRight=!0,this._op=s.EQ,this._isSealed=!1,this._left=e,this._right=t,this._op=r,this._expType=this.resultAutoType(e,t,r),"null"===this._expType&&(this.isRight=!1,console.log("公式两边类型不匹配，左侧类型："+e.expType+"，右侧类型："+t.expType+"，计算类型："+r.toString()))}r.BinaryExpression=l;var _=(Object.defineProperty(f.prototype,"expType",{get:function(){return this._value?this._value.varType:"null"},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"className",{get:function(){return"VeryVarExpression"},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"value",{get:function(){return this._value},enumerable:!0,configurable:!0}),f.prototype.evaluate=function(){return this._value.getValue()},f.prototype.clone=function(){return new f(this._value.clone())},f.prototype.toString=function(){return this._value?this._value.toString():"null"},f);function f(e){this._value=e}r.VeryVarExpression=_;var g=(Object.defineProperty(d.prototype,"expType",{get:function(){return"bool"},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"className",{get:function(){return"VeryTemplateExpression"},enumerable:!0,configurable:!0}),d.prototype.setTemplate=function(e){this._isTemplate=!0,this._template=e},d.prototype.evaluate=function(){return!!this._isTemplate&&!!this._template&&null!==this._template.templateInstance},d.prototype.clone=function(){var e=new d;return e._template=this._template,e._isTemplate=this._isTemplate,e},d.prototype.toString=function(){return this._isTemplate&&this._template?(null===this._template.templateInstance).toString():"false"},d);function d(){this._isTemplate=!1,this._template=new n.VE_Template("","")}r.VeryTemplateExpression=g,l.init()},{"../template":64,"../utility/dictionary":71}],23:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.prototype.next=function(){return this.nextOffset(1)},n.prototype.nextOffset=function(e){for(;this.itemBuffer.length<=e&&!this.endReached;){var t=this.fetch();void 0!==t?this.itemBuffer.push(t):this.endReached=!0}return e>=this.itemBuffer.length?(void 0===this.endOfInputIndicator&&(this.endOfInputIndicator=this.endOfInput()),this.endOfInputIndicator):this.itemBuffer[e]},n.prototype.current=function(){return this.nextOffset(0)},n.prototype.consume=function(){var e=this.current();return this.consumeNext(1),e},n.prototype.consumeNext=function(e){if(!(e<0))for(;0<e--;)if(0!==this.itemBuffer.length)this.itemBuffer.shift();else{if(this.endReached)return;void 0===this.fetch()&&(this.endReached=!0)}},n.prototype.getProblemCollector=function(){return this.problemCollector},n.prototype.setProblemCollector=function(e){this.problemCollector=e},n);function n(){this.itemBuffer=[],this.endReached=!1,this.problemCollector=[],this.endOfInputIndicator=void 0}r.ForwardQuery=i},{}],24:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n.prototype,"expType",{get:function(){return this._function.expType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return this._function.className},enumerable:!0,configurable:!0}),n.prototype.setFunction=function(e){this._function=e},n.prototype.addPara=function(e){this._paras.push(e)},n.prototype.paraCount=function(){return this._paras.length},n.prototype.evaluate=function(){var e=null;try{e=this._function.evaluate(this._paras)}catch(e){return console.log("自定义函数编译错误，错误信息："+e),null}return e},n.prototype.clone=function(){var e=new n;e._function=this._function;for(var t=0;t<this._paras.length;t++)e._paras.push(this._paras[t].clone());return e},n.prototype.toString=function(){for(var e=this._function.className+"(",t=0;t<this._paras.length;t++)e+=0<t?","+this._paras[t].toString():this._paras[t].toString();return e+")"},n);function n(){this._paras=[]}r.FunctionExpression=i},{}],25:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../html"),i=(Object.defineProperty(a.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"className",{get:function(){return"pow"},enumerable:!0,configurable:!0}),a.prototype.parameterNumber=function(){return 2},a.prototype.evaluate=function(e){var t=Math.pow(e[0].evaluate(),e[1].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：Pow函数参数错误，参数1类型："+e[0].expType+"，参数1值："+e[0].evaluate()+"，参数2类型："+e[1].expType+"，参数2值："+e[1].evaluate()+"，请检查！"):t},a);function a(){}r.Pow=i;var o=(Object.defineProperty(s.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"className",{get:function(){return"ln"},enumerable:!0,configurable:!0}),s.prototype.parameterNumber=function(){return 1},s.prototype.evaluate=function(e){var t=Math.log(e[0].evaluate());return NaN===t||t===1/0?void n.ShowError.showError("表达式编译错误：Ln函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},s);function s(){}r.Ln=o;var u=(Object.defineProperty(p.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(p.prototype,"className",{get:function(){return"lg"},enumerable:!0,configurable:!0}),p.prototype.parameterNumber=function(){return 1},p.prototype.evaluate=function(e){var t=Math.log10(e[0].evaluate());return NaN===t||t===1/0?void n.ShowError.showError("表达式编译错误：Lg函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},p);function p(){}r.Lg=u;var c=(Object.defineProperty(l.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(l.prototype,"className",{get:function(){return"sqrt"},enumerable:!0,configurable:!0}),l.prototype.parameterNumber=function(){return 1},l.prototype.evaluate=function(e){var t=Math.sqrt(e[0].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：Sqrt函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},l);function l(){}r.Sqrt=c;var h=(Object.defineProperty(_.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(_.prototype,"className",{get:function(){return"abs"},enumerable:!0,configurable:!0}),_.prototype.parameterNumber=function(){return 1},_.prototype.evaluate=function(e){var t=Math.abs(e[0].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：Abs函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},_);function _(){}r.Abs=h;var f=(Object.defineProperty(g.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(g.prototype,"className",{get:function(){return"random"},enumerable:!0,configurable:!0}),g.prototype.parameterNumber=function(){return 2},g.prototype.evaluate=function(e){var t=e[0].evaluate(),r=e[1].evaluate()-e[0].evaluate(),i=Math.random()*r+t;return NaN===i?void n.ShowError.showError("表达式编译错误：Random函数参数错误，参数1类型："+e[0].expType+"，参数1值："+e[0].evaluate()+"，参数2类型："+e[1].expType+"，参数2值："+e[1].evaluate()+"，请检查！"):i},g);function g(){}r.Random=f;var d=(Object.defineProperty(y.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(y.prototype,"className",{get:function(){return"round"},enumerable:!0,configurable:!0}),y.prototype.parameterNumber=function(){return 1},y.prototype.evaluate=function(e){var t=Math.round(e[0].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：Round函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},y);function y(){}r.Round=d;var m=(Object.defineProperty(E.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(E.prototype,"className",{get:function(){return"sin"},enumerable:!0,configurable:!0}),E.prototype.parameterNumber=function(){return 1},E.prototype.evaluate=function(e){var t=Math.sin(e[0].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：Sin函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},E);function E(){}r.Sin=m;var b=(Object.defineProperty(v.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(v.prototype,"className",{get:function(){return"asin"},enumerable:!0,configurable:!0}),v.prototype.parameterNumber=function(){return 1},v.prototype.evaluate=function(e){var t=Math.asin(e[0].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：ASin函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},v);function v(){}r.ASin=b;var V=(Object.defineProperty(T.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(T.prototype,"className",{get:function(){return"cos"},enumerable:!0,configurable:!0}),T.prototype.parameterNumber=function(){return 1},T.prototype.evaluate=function(e){var t=Math.cos(e[0].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：Cos函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},T);function T(){}r.Cos=V;var S=(Object.defineProperty(D.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(D.prototype,"className",{get:function(){return"acos"},enumerable:!0,configurable:!0}),D.prototype.parameterNumber=function(){return 1},D.prototype.evaluate=function(e){var t=Math.acos(e[0].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：ACos函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},D);function D(){}r.ACos=S;var x=(Object.defineProperty(O.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(O.prototype,"className",{get:function(){return"tan"},enumerable:!0,configurable:!0}),O.prototype.parameterNumber=function(){return 1},O.prototype.evaluate=function(e){var t=Math.tan(e[0].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：Tan函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},O);function O(){}r.Tan=x;var C=(Object.defineProperty(I.prototype,"expType",{get:function(){return"number"},enumerable:!0,configurable:!0}),Object.defineProperty(I.prototype,"className",{get:function(){return"atan"},enumerable:!0,configurable:!0}),I.prototype.parameterNumber=function(){return 1},I.prototype.evaluate=function(e){var t=Math.atan(e[0].evaluate());return NaN===t?void n.ShowError.showError("表达式编译错误：ATan函数参数错误，参数类型："+e[0].expType+"，参数值："+e[0].evaluate()+"，请检查！"):t},I);function I(){}r.ATan=C;var j=(P.hasFunction=function(e){return e=e.toLowerCase(),!!this._functions[e]},P.addFunction=function(e){var t=e.className.toLowerCase();this._functions[t]?n.ShowError.showError("自定义函数初始化错误，函数ID重复，当前函数ID："+t+"，请为当前自定义函数重新分配ID！"):this._functions[t]=e},P.createFunction=function(e){return e=e.toLowerCase(),Object.create(this._functions[e])},P.remove=function(e){e=e.toLowerCase(),delete this._functions[e]},P._functions={},P);function P(){}(r.CustomFunctions=j).addFunction(new i),j.addFunction(new o),j.addFunction(new u),j.addFunction(new c),j.addFunction(new h),j.addFunction(new f),j.addFunction(new d),j.addFunction(new m),j.addFunction(new b),j.addFunction(new V),j.addFunction(new S),j.addFunction(new x),j.addFunction(new C)},{"../html":39}],26:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./expressionEnum")),i(e("./expressions")),i(e("./functions")),i(e("./positions")),i(e("./expChar")),i(e("./token")),i(e("./forwardQuery")),i(e("./tokenizer")),i(e("./tokenReader")),i(e("./variable")),i(e("./variableExpression")),i(e("./scope")),i(e("./functionExpression")),i(e("./expressionParsing")),i(e("./expManager")),i(e("./veryExpressions"))},{"./expChar":18,"./expManager":19,"./expressionEnum":20,"./expressionParsing":21,"./expressions":22,"./forwardQuery":23,"./functionExpression":24,"./functions":25,"./positions":27,"./scope":28,"./token":29,"./tokenReader":30,"./tokenizer":31,"./variable":32,"./variableExpression":33,"./veryExpressions":34}],27:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i,n,a=(o.prototype.getValue=function(){return this._value},o.prototype.getLine=function(){return this._line},o.prototype.getPos=function(){return this._pos},o);function o(e){this._value="",this._line=0,this._pos=0,this._value=e,this._line=1,this._pos=1}r.NameLocation=a,(n=i=r.SeverityExp||(r.SeverityExp={}))[n.Warning=0]="Warning",n[n.Error=1]="Error";var s=(u.Warning=function(e,t){var r=t;return 0<e.getLine()&&(r="警告>>>行号："+e.getLine()+"，字符序号："+e.getPos()+"，警告信息："+t),new u(e,r,i.Warning)},u.Error=function(e,t){var r=t;return 0<e.getLine()&&(r="错误>>>行号："+e.getLine()+"，字符序号："+e.getPos()+"，警告信息："+t),new u(e,r,i.Error)},u.prototype.getPosition=function(){return this._pos},u.prototype.getMessage=function(){return this._message},u.prototype.getSeverity=function(){return this._severity},u.prototype.toString=function(){return"类型："+this._severity.toString()+"，信息："+this._message},u);function u(e,t,r){this._pos=e,this._message=t,this._severity=r}r.ParseError=s},{}],28:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./variable"),i=(a.Create=function(){var e=new a;return e._parent=a.GetRootScope(),e},a.GetRootScope=function(){return void 0===a._root&&((a._root=new a).setVariable("PI","number",Math.PI).makeConstant(Math.PI),a._root.setVariable("EULER","number",Math.E).makeConstant(Math.E)),a._root},a.CreateWithParent=function(e){var t=a.Create();return t._parent=e,t},a.prototype.find=function(e){return this._context[e]?this._context[e]:void 0!==this._parent?this._parent.find(e):null},a.prototype.setVariable=function(e,t,r){var i=this.find(e);return null!==i?(i.setType(t),i.setValue(r),i):this.createVariable(e,t,r)},a.prototype.createVariable=function(e,t,r){if(this._context[e])return this._context[e].setType(t),this._context[e].setValue(r),this._context[e];var i=new n.Variable(e,t,r);return this._context[e]=i},a.prototype.setValue=function(e,t){this._context[e]&&this._context[e].setValue(t)},a.prototype.isCreated=function(e){return!!this._context[e]||void 0!==this._parent&&null!==this._parent.find(e)},a.prototype.clear=function(){this._context={}},a);function a(){this._parent=void 0,this._context={}}r.Scope=i},{"./variable":32}],29:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./expressionEnum"),i=(a.Create=function(e,t){var r=new a;return r.type=e,r._line=t.getLine(),r._pos=t.getPos(),r},a.CreateAndFill=function(e,t){var r=new a;return r.type=e,r._line=t.getLine(),r._pos=t.getPos(),r._contents=t.getValue(),r._trigger=t.getValue(),r._source=t.toString(),r},a.prototype.addToTrigger=function(e){return this._trigger+=e.getValue(),this._source+=e.getValue(),this},a.prototype.addToSource=function(e){return this._source+=e.getValue(),this},a.prototype.addToContentChar=function(e){return this.addToContent(e.getValue()),this},a.prototype.addToContent=function(e){return this._contents+=e,this._source+=e,this},a.prototype.getTrigger=function(){return this._trigger},a.prototype.getTokenType=function(){return this.type},a.prototype.getContents=function(){return this._contents},a.prototype.getSource=function(){return this._source},a.prototype.getLine=function(){return this._line},a.prototype.getPos=function(){return this._pos},a.prototype.setTokenType=function(e){this.type=e},a.prototype.setTrigger=function(e){this._trigger=e},a.prototype.setContent=function(e){this._contents=e},a.prototype.setSource=function(e){this._source=e},a.prototype.isEnd=function(){return this.type===n.ExpressionType.EOI},a.prototype.is=function(e){return this.type===e},a.prototype.matches=function(e,t){return!!this.is(e)&&""!==t&&this.getTrigger()===t},a.prototype.isOperator=function(e){if(0===e.length)return this.is(n.ExpressionType.OPERATOR);for(var t=0;t<e.length;t++)if(this.matches(n.ExpressionType.OPERATOR,e[t]))return!0;return!1},a.prototype.isStartBracket=function(){return!!this.is(n.ExpressionType.OPERATOR)&&("("===this._trigger||"（"===this._trigger)},a.prototype.isEndBracket=function(){return!!this.is(n.ExpressionType.OPERATOR)&&(")"===this._trigger||"）"===this._trigger)},a.prototype.isStartSquareBracket=function(){return!!this.is(n.ExpressionType.OPERATOR)&&("["===this._trigger||"【"===this._trigger)},a.prototype.isEndSquareBracket=function(){return!!this.is(n.ExpressionType.OPERATOR)&&("]"===this._trigger||"】"===this._trigger)},a.prototype.isStartBrace=function(){return!!this.is(n.ExpressionType.OPERATOR)&&"{"===this._trigger},a.prototype.isEndBrace=function(){return!!this.is(n.ExpressionType.OPERATOR)&&"}"===this._trigger},a.prototype.isKeyword=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return this.is(n.ExpressionType.KEYWORD);for(var r=0;r<e.length;r++)if(this.matches(n.ExpressionType.KEYWORD,e[r]))return!0;return!1},a.prototype.isIdentifier=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return this.is(n.ExpressionType.ID);for(var r=0;r<e.length;r++)if(this.matches(n.ExpressionType.ID,e[r]))return!0;return!1},a.prototype.isSpecialIdentifier=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return this.is(n.ExpressionType.SPECIAL_ID);for(var r=0;r<e.length;r++)if(this.matches(n.ExpressionType.SPECIAL_ID,e[r]))return!0;return!1},a.prototype.isSpecialIdentifierWithContent=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(!this.matches(n.ExpressionType.SPECIAL_ID,e))return!1;if(0===t.length)return!0;for(var i=0;i<t.length;i++)if(this.getContents()===t[i])return!0;return!1},a.prototype.isNumber=function(){return this.is(n.ExpressionType.NUMBER)},a.prototype.isBool=function(){return this.is(n.ExpressionType.BOOL)},a.prototype.isString=function(){return this.is(n.ExpressionType.STRING)},a.prototype.isConstant=function(){return this.isNumber()||this.isBool()||this.isString()},a.prototype.toString=function(){return this.getTokenType().toString()+": "+this.getContents()+" ("+this._line+": "+this._pos+"), Trigger: "+this.getTrigger()},a);function a(){this.type=n.ExpressionType.STRING,this._source="",this._contents="",this._trigger="",this._line=0,this._pos=0}r.Token=i},{"./expressionEnum":20}],30:[function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var a,o=e("./forwardQuery"),s=e("./expChar"),u=(a=o.ForwardQuery,n(p,a),p.prototype.endOfInput=function(){return new s.ExpChar("\0",this._line,this._pos)},p.prototype.fetch=function(){if(this._operator<=this._count-1){var e=this._inputExp[this._operator];return this._operator++,"\n"===e&&(this._line++,this._pos=0),this._pos++,new s.ExpChar(e,this._line,this._pos)}},p.prototype.toString=function(){return 0===this.itemBuffer.length?this._line+":"+this._pos+": Buffer empty":this.itemBuffer.length<2?this._line+":"+this._pos+": "+this.current().toString():this._line+":"+this._pos+": "+this.current().toString()+", "+this.next().toString()},p);function p(e){var t=a.call(this)||this;return t._inputExp="",t._line=1,t._pos=0,t._count=0,t._operator=0,t._inputExp=e,t._count=e.length,t._operator=0,t}r.TokenReader=u},{"./expChar":18,"./forwardQuery":23}],31:[function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var a,o=e("./forwardQuery"),s=e("./token"),u=e("./tokenReader"),p=e("./expressionEnum"),c=e("./positions"),l=(a=o.ForwardQuery,n(h,a),h.prototype.endOfInput=function(){return s.Token.CreateAndFill(p.ExpressionType.EOI,this._inputExp.current())},h.prototype.fetch=function(){for(;this._inputExp.current().isWhiteSpace();)this._inputExp.consume();if(!this._inputExp.current().isEndOfInput())return this.isAtStartOfLineComment(!0)?(this.skipToEndOfLine(),this.fetch()):this.isAtStartOfBlockComment(!0)?(this.skipBlockComment(),this.fetch()):this.isAtStartOfNumber()?this.fetchNumber():this.isAtStartOfIdentifier()?this.fetchId():this._stringDelimiters[this._inputExp.current().getValue()]?this.fetchString():this.isAtBracket(!1)?s.Token.CreateAndFill(p.ExpressionType.OPERATOR,this._inputExp.consume()):this.isAtStartOfSpecialId()?this.fetchSpecialId():this.isOperator(this._inputExp.current())?this.fetchOperator():(this.problemCollector.push(c.ParseError.Error(this._inputExp.current(),"无效的输入字符: "+this._inputExp.current().getValue())),this._inputExp.consume(),this.fetch())},h.prototype.fetchNumber=function(){var e=s.Token.Create(p.ExpressionType.NUMBER,this._inputExp.current());e.addToContentChar(this._inputExp.consume());for(var t=!1;this._inputExp.current().isDigit()||this._inputExp.current().is(this._decimalSeparator);)this._inputExp.current().is(this._decimalSeparator)&&(t&&this.problemCollector.push(c.ParseError.Error(this._inputExp.current(),"公式中有多个小数点！")),t=!0),e.addToContentChar(this._inputExp.consume());return e},h.prototype.fetchId=function(){var e=s.Token.Create(p.ExpressionType.ID,this._inputExp.current());for(e.addToContentChar(this._inputExp.consume());this.isIdentifierChar(this._inputExp.current());)e.addToContentChar(this._inputExp.consume());if(!this._inputExp.current().isEndOfInput()&&-1<this._specialIdTerminators.indexOf(this._inputExp.current().getValue())){var t=s.Token.Create(p.ExpressionType.SPECIAL_ID,e);return t.setTrigger(this._inputExp.current().getValue()),t.setContent(e.getContents()),t.setSource(e.getContents()),t.addToSource(this._inputExp.current()),this._inputExp.consume(),this.handleKeywords(t)}return this.handleKeywords(e)},h.prototype.fetchString=function(){var e=this._inputExp.current().getValue(),t=s.Token.Create(p.ExpressionType.STRING,this._inputExp.current());for(t.addToTrigger(this._inputExp.consume());!this._inputExp.current().isNewLine()&&!this._inputExp.current().is(e)&&!this._inputExp.current().isEndOfInput();)t.addToContentChar(this._inputExp.consume());return this._inputExp.current().is(e)?t.addToSource(this._inputExp.consume()):this.problemCollector.push(c.ParseError.Error(this._inputExp.current(),"常量字符串没有结束分隔符！")),t},h.prototype.isAtStartOfLineComment=function(e){return""!==this._lineComment&&this.canConsumeThisString(this._lineComment,e)},h.prototype.canConsumeThisString=function(e,t){for(var r=0;r<e.length;r++)if(!this._inputExp.nextOffset(r).is(e[r]))return!1;return t&&this._inputExp.consumeNext(e.length),!0},h.prototype.skipToEndOfLine=function(){for(;!this._inputExp.current().isEndOfInput()&&!this._inputExp.current().isNewLine();)this._inputExp.consume()},h.prototype.isAtStartOfBlockComment=function(e){return this.canConsumeThisString(this._blockCommentStart,e)},h.prototype.skipBlockComment=function(){for(;!this._inputExp.current().isEndOfInput();){if(this.isAtEndOfBlockComment())return;this._inputExp.consume()}this.problemCollector.push(c.ParseError.Error(this._inputExp.current(),"块注释没有结束符！"))},h.prototype.isAtEndOfBlockComment=function(){return this.canConsumeThisString(this._blockCommentEnd,!0)},h.prototype.isAtStartOfNumber=function(){return!!this._inputExp.current().isDigit()||!(!this._inputExp.current().is(".")||!this._inputExp.next().isDigit())},h.prototype.isAtStartOfIdentifier=function(){return this._inputExp.current().isLetter()||this._inputExp.current().is("_")||this._inputExp.current().is("#")},h.prototype.isIdentifierChar=function(e){return e.isDigit()||e.isLetter()||e.is("_")||e.is(".")||e.is("#")||e.is(":")||e.is("：")},h.prototype.isAtBracket=function(e){for(var t=!0,r=0;r<this._brackets.length;r++)this._inputExp.current().is(this._brackets[r])||(t=!1);return!!t||!(e||!this._treatSinglePipeAsBracket||!this._inputExp.current().is("|")||!this._inputExp.next().is("|"))},h.prototype.isAtStartOfSpecialId=function(){return-1<this._specialIdStarters.indexOf(this._inputExp.current().getValue())},h.prototype.fetchSpecialId=function(){var e=s.Token.Create(p.ExpressionType.SPECIAL_ID,this._inputExp.current());for(e.addToTrigger(this._inputExp.consume());this.isIdentifierChar(this._inputExp.current());)e.addToContentChar(this._inputExp.consume());return this.handleKeywords(e)},h.prototype.handleKeywords=function(e){var t="";if(this._keywordsCaseSensitive?this._keywords[e.getContents()]&&(t=this._keywords[e.getContents()]):this._keywords[e.getContents().toLowerCase()]&&(t=this._keywords[e.getContents().toLowerCase()]),""==t)return e.is(p.ExpressionType.SPECIAL_ID)||(t=e.getContents().toLowerCase(),-1<this._boolConstant.indexOf(t)&&e.setTokenType(p.ExpressionType.BOOL)),e;var r=s.Token.Create(p.ExpressionType.KEYWORD,e);return r.setTrigger(t),r.setContent(e.getContents()),r.setSource(e.getSource()),r},h.prototype.isOperator=function(e){return!(e.isEndOfInput()||e.isDigit()||e.isLetter()||e.isWhiteSpace()||this.isAtBracket(!0)||this.isAtStartOfBlockComment(!1)||this.isAtStartOfLineComment(!1)||this.isAtStartOfNumber()||this.isAtStartOfIdentifier()||this._stringDelimiters[e.getValue()])},h.prototype.fetchOperator=function(){var e=s.Token.Create(p.ExpressionType.OPERATOR,this._inputExp.current());return e.addToTrigger(this._inputExp.consume()),e.isOperator("*")&&this._inputExp.current().is("*")?e.addToTrigger(this._inputExp.consume()):e.isOperator("&")&&this._inputExp.current().is("&")?e.addToTrigger(this._inputExp.consume()):e.isOperator("|")&&this._inputExp.current().is("|")?e.addToTrigger(this._inputExp.consume()):e.isOperator("<")&&this._inputExp.current().is("=")?e.addToTrigger(this._inputExp.consume()):e.isOperator(">")&&this._inputExp.current().is("=")?e.addToTrigger(this._inputExp.consume()):e.isOperator("!")&&this._inputExp.current().is("=")?e.addToTrigger(this._inputExp.consume()):e.isOperator("=")&&this._inputExp.current().is("=")&&e.addToTrigger(this._inputExp.consume()),e},h.prototype.addError=function(e,t){this.getProblemCollector().push(c.ParseError.Error(e,t))},h.prototype.addWarning=function(e,t){this.getProblemCollector().push(c.ParseError.Warning(e,t))},h);function h(e){var t=a.call(this)||this;return t._decimalSeparator=".",t._lineComment="//",t._blockCommentStart="/*",t._blockCommentEnd="*/",t._brackets=["(",")","（","）","[","]","{","}","【","】"],t._treatSinglePipeAsBracket=!0,t._specialIdStarters=[],t._specialIdTerminators=[],t._keywords={},t._keywordsCaseSensitive=!1,t._stringDelimiters={},t._boolConstant=[],t._inputExp=new u.TokenReader(e),t._stringDelimiters={},t._stringDelimiters['"']="\\",t._stringDelimiters["'"]="\0",t._boolConstant=[],t._boolConstant.push("false"),t._boolConstant.push("true"),t._keywords={},t._keywords.this="this",t._keywords.null="null",t._keywords.none="none",t._keywords[void 0]="undefined",t}r.Tokenizer=l},{"./expressionEnum":20,"./forwardQuery":23,"./positions":27,"./token":29,"./tokenReader":30}],32:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n.prototype,"expType",{get:function(){return this._expType},enumerable:!0,configurable:!0}),n.prototype.setType=function(e){this._constant||(this._expType=e)},n.prototype.setValue=function(e){this._constant||(this._value=e)},n.prototype.makeConstant=function(e){this.setValue(e),this._constant=!0},n.prototype.getValue=function(){return this._value},n.prototype.getName=function(){return this._name},n.prototype.isConstant=function(){return this._constant},n.prototype.toString=function(){return"Type: "+this._expType+" --- "+this._name+": "+this._value.toString()},n);function n(e,t,r){this._expType="string",this._value=null,this._name="",this._constant=!1,this._name=e,this._expType=t,this._value=r}r.Variable=i},{}],33:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n.prototype,"expType",{get:function(){return this._value.expType},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"className",{get:function(){return"VariableExpression"},enumerable:!0,configurable:!0}),n.prototype.evaluate=function(){return this._value.getValue()},n.prototype.toString=function(){return this._value.getName()},n.prototype.clone=function(){return new n(this._value)},n);function n(e){this._value=e}r.VariableExpression=i},{}],34:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./scope"),c=e("./expressions"),s=e("./expressionParsing"),l=e("../enum"),n=e("../scene"),h=e("../manager"),_=e("../state"),a=(u.createSceneExpression=function(e,t,r){var i=s.VE_ExpressionParsing.parsing(e,t,u._scope,"","","",l.VariableScope.Scene);return 0<s.VE_ExpressionParsing.errors.length&&(r.isRight=!1,r.message=u.errorMessage(s.VE_ExpressionParsing.errors)),i},u.createGlobalExpression=function(e,t,r,i){var n=s.VE_ExpressionParsing.parsing(e,t,u._scope,r,"","",l.VariableScope.Global);return 0<s.VE_ExpressionParsing.errors.length&&(i.isRight=!1,i.message=u.errorMessage(s.VE_ExpressionParsing.errors)),n},u.createLocalExpression=function(e,t,r,i,n){var a=s.VE_ExpressionParsing.parsing(e,t,u._scope,r,i,"",l.VariableScope.Local);return 0<s.VE_ExpressionParsing.errors.length&&(n.isRight=!1,n.message=u.errorMessage(s.VE_ExpressionParsing.errors)),a},u.createFsmExpression=function(e,t,r,i,n,a){var o=s.VE_ExpressionParsing.parsing(e,t,u._scope,r,i,n,l.VariableScope.Fsm);return 0<s.VE_ExpressionParsing.errors.length&&(a.isRight=!1,a.message=u.errorMessage(s.VE_ExpressionParsing.errors)),o},u.getParseExpression=function(e,t,r,i){if(-1<r.indexOf(_.StateConst.STATE_SEPARATOR)){var n=r.split(_.StateConst.STATE_SEPARATOR);if(2!==n.length)return null;if(t=n[0].trim(),r=n[1].trim().substring(1),i!==l.VariableScope.Local&&i!==l.VariableScope.Fsm)return null;if(o=h.VE_Manager.objects(e)){if(s=o.getVeryObject(t)){if(s.isCreatedVariable(r)){var a=s.getVariable(r);return new c.VeryVarExpression(a)}return s.isCreatedExpression(r)?s.getExpression(r):s.isCreatedFsm(r)?(a=s.getFsm(r).fsmVar,new c.VeryVarExpression(a)):null}return null}return null}var o,s;return r.startsWith(_.StateConst.VARIABLE_SYMBOL)?(r=r.substring(1),i!==l.VariableScope.Local&&i!==l.VariableScope.Fsm?i===l.VariableScope.Global?this.getParseGlobal(e,r):this.getParseScene(r):(o=h.VE_Manager.objects(e))&&(s=o.getVeryObject(t))?s.isCreatedVariable(r)?(a=s.getVariable(r),new c.VeryVarExpression(a)):s.isCreatedExpression(r)?s.getExpression(r):s.isCreatedFsm(r)?(a=s.getFsm(r).fsmVar,new c.VeryVarExpression(a)):this.getParseGlobal(e,r):null):null},u.getParseGlobal=function(e,t){var r=h.VE_Manager.variables(e);if(r){if(r.isCreatedVariable(t)){var i=r.getVariable(t);return new c.VeryVarExpression(i)}return r.isCreatedExpression(t)?r.getExpression(t):this.getParseScene(t)}return null},u.getParseScene=function(e){if(n.VerySceneVariables.Variables.isCreated(e)){var t=n.VerySceneVariables.Variables.getVariable(e);return new c.VeryVarExpression(t)}return n.VerySceneVariables.Variables.isCreatedExpression(e)?n.VerySceneVariables.Variables.getExpression(e):null},u.errorMessage=function(e){for(var t="",r=0;r<e.length;r++)t+=e[r].getMessage()+";\n";return t},u.getTemplateExpression=function(e,t,r,i){if(-1<r.indexOf(_.StateConst.STATE_SEPARATOR)){var n=r.split(_.StateConst.STATE_SEPARATOR);if(2!==n.length)return null;if(t=n[0].trim(),r=n[1].trim().substring(1),i!==l.VariableScope.Local&&i!==l.VariableScope.Fsm)return null;if(o=h.VE_Manager.objects(e)){if(s=o.getVeryObject(t)){if(s.isCreatedTemplate(r)){var a=s.getTemplate(r);return(p=new c.VeryTemplateExpression).setTemplate(a),p}return null}return null}return null}var o,s,u,p;return r.startsWith(_.StateConst.VARIABLE_SYMBOL)?(r=r.substring(1),i===l.VariableScope.Local||i===l.VariableScope.Fsm?(o=h.VE_Manager.objects(e))&&(s=o.getVeryObject(t))?s.isCreatedTemplate(r)?(a=s.getTemplate(r),(p=new c.VeryTemplateExpression).setTemplate(a),p):(u=h.VE_Manager.variables(e))&&u.isCreatedTemplate(r)?(a=u.getTemplate(r),(p=new c.VeryTemplateExpression).setTemplate(a),p):null:null:i!==l.VariableScope.Global?null:(u=h.VE_Manager.variables(e))&&u.isCreatedTemplate(r)?(a=u.getTemplate(r),(p=new c.VeryTemplateExpression).setTemplate(a),p):null):null},u._scope=i.Scope.Create(),u);function u(){}r.VE_Expressions=a},{"../enum":17,"../manager":49,"../scene":56,"../state":60,"./expressionParsing":21,"./expressions":22,"./scope":28}],35:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../enum"),i=(a.warning=function(e,t,r){return new a(e,t,r,n.Severity.Warning)},a.error=function(e,t,r){return new a(e,t,r,n.Severity.Error)},a.prototype.getPos=function(){return this._pos},a.prototype.getMessage=function(){return this._message},a.prototype.getTableName=function(){return this._tableName},a.prototype.getSeverity=function(){return this._severity},a.prototype.toString=function(){return"位置："+this._pos+"，错误信息："+this._message+"，表格名："+this._tableName},a);function a(e,t,r,i){this._pos="",this._message="",this._tableName="",this._severity=n.Severity.Error,this._pos=e,this._message=t,this._severity=i,this._tableName=r}r.VE_Error=i;var o=(Object.defineProperty(s,"count",{get:function(){return this._errorList.length},enumerable:!0,configurable:!0}),s.add=function(e){this._errorList.push(e)},s.getError=function(e){return this._errorList[e]},s.print=function(e){if(e)for(var t=0;t<this._errorList.length;t++)this._errorList[t].getSeverity()===n.Severity.Error?(console.log("错误："+e+" -> "+this._errorList[t].toString()),this._errorList.splice(t,1),t--):this._errorList[t].getSeverity()===n.Severity.Warning&&(console.log("警告："+e+" -> "+this._errorList[t].toString()),this._errorList.splice(t,1),t--);else for(t=0;t<this._errorList.length;t++)this._errorList[t].getSeverity()===n.Severity.Error?(console.log("错误："+this._errorList[t].toString()),this._errorList.splice(t,1),t--):this._errorList[t].getSeverity()===n.Severity.Warning&&(console.log("警告："+this._errorList[t].toString()),this._errorList.splice(t,1),t--)},s.printWarnning=function(e){if(e)for(var t=0;t<this._errorList.length;t++)this._errorList[t].getSeverity()===n.Severity.Warning&&(console.log("警告："+e+" -> "+this._errorList[t].toString()),this._errorList.splice(t,1),t--);else for(t=0;t<this._errorList.length;t++)this._errorList[t].getSeverity()===n.Severity.Warning&&(console.log("警告："+this._errorList[t].toString()),this._errorList.splice(t,1),t--)},s.printError=function(e){if(e)for(var t=0;t<this._errorList.length;t++)this._errorList[t].getSeverity()===n.Severity.Error&&(console.log("错误："+e+" -> "+this._errorList[t].toString()),this._errorList.splice(t,1),t--);else for(t=0;t<this._errorList.length;t++)this._errorList[t].getSeverity()===n.Severity.Error&&(console.log("错误："+e+" -> "+this._errorList[t].toString()),this._errorList.splice(t,1),t--)},s._errorList=[],s);function s(){}r.VE_ErrorManager=o},{"../enum":17}],36:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});function i(){}r.GameGlobal=i},{}],37:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./gameGlobal")),i(e("./time")),i(e("./errorManager"))},{"./errorManager":35,"./gameGlobal":36,"./time":38}],38:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../veryEngine"),n=(Object.defineProperty(a,"frameCount",{get:function(){return this._frame},enumerable:!0,configurable:!0}),Object.defineProperty(a,"deltaTime",{get:function(){return i.VeryEngine.Engine.getDeltaTime()/1e3},enumerable:!0,configurable:!0}),a._sum=function(){this._frame++},a._frame=0,a);function a(){}r.Time=n},{"../veryEngine":81}],39:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(e("./showError"))},{"./showError":40}],40:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.initZone=function(){this.errorZone||(this.errorZone=document.getElementById("errorZone"))},n.showMsg=function(e,t){this.initZone(),this.errorContentNow||(this.errorContentNow=this.errorContentPrefix),this.errorContentNow+=e+t+"<br/>",this.errorZone.style.display="block",this.errorZone.innerHTML=this.errorContentNow+"</div>";var r=this.errorZone.querySelector(".close"),i=this;r.addEventListener("click",function(){i.errorZone.style.display="none"})},n.show=function(e){this.showMsg("打印信息>>>",e)},n.showError=function(e){this.showMsg("错误信息>>>",e)},n.showWarn=function(e){this.showMsg("警告信息>>>",e)},n.clear=function(){n.initZone(),n.errorContentNow=n.errorContentPrefix,n.errorZone.innerHTML=n.errorContentNow+"</div>";var e=n.errorZone.querySelector(".close"),t=n;e.addEventListener("click",function(){t.errorZone.style.display="none"})},n.close=function(){n.initZone(),"none"===n.errorZone.style.display?n.errorZone.style.display="block":n.errorZone.style.display="none"},n.errorContentPrefix='<div class="alert alert-error"><button type="button" class="close" data-dismiss="alert">&times;</button>',n);function n(){}r.ShowError=i},{}],41:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./utility/index")),i(e("./action/index")),i(e("./dataSource/index")),i(e("./enum/index")),i(e("./expression/index")),i(e("./global/index")),i(e("./html/index")),i(e("./manager/index")),i(e("./object/index")),i(e("./state/index")),i(e("./template/index")),i(e("./trigger/index")),i(e("./loader/index")),i(e("./variables/index")),i(e("./scene/index")),i(e("../verytable/index")),i(e("./library/action/index")),i(e("./library/trigger/index"))},{"../verytable/index":82,"./action/index":7,"./dataSource/index":11,"./enum/index":17,"./expression/index":26,"./global/index":37,"./html/index":39,"./library/action/index":42,"./library/trigger/index":44,"./loader/index":47,"./manager/index":49,"./object/index":53,"./scene/index":56,"./state/index":60,"./template/index":64,"./trigger/index":67,"./utility/index":73,"./variables/index":77}],42:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(e("./translate"))},{"./translate":43}],43:[function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var a,o=e("../../index"),s=(a=o.VE_ActionBehaviour,n(u,a),Object.defineProperty(u.prototype,"ID",{get:function(){return"直线运动|Translate"},enumerable:!0,configurable:!0}),u.prototype.active=function(){},u.prototype.onUpdate=function(){},u.prototype.destroy=function(){},u);function u(){var e=null!==a&&a.apply(this,arguments)||this;return e._refType=BABYLON.Space.LOCAL,e}r.Action_Translate=s},{"../../index":41}],44:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(e("./input"))},{"./input":45}],45:[function(e,t,r){"use strict";var i,n=this&&this.__extends||(i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])})(e,t)},function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(r,"__esModule",{value:!0});var a,o=e("../../index"),s=e("../../trigger"),u=(a=o.VE_TriggerBehaviour,n(p,a),Object.defineProperty(p.prototype,"ID",{get:function(){return"鼠标按下|Mouse_Down"},enumerable:!0,configurable:!0}),p.prototype.paraParser=function(e){var t=this.scene.onPointerObservable.add(function(e){});return this.scene.onPointerObservable.remove(t),!0},p.prototype.onUpdate=function(){},p.prototype.destroy=function(){},p);function p(){return a.call(this)||this}r.Trigger_MouseDown=u,s.VE_Triggers.addTrigger(new u)},{"../../index":41,"../../trigger":67}],46:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var U=e("../manager"),K=e("../variables"),X=e("../utility"),J=e("../global"),H=e("../expression"),$=e("../state"),ee=e("../trigger"),te=e("../action"),re=e("../enum"),ie=e("../utility/typeConvert"),D=e("../action/assignmentTypeJudge"),x=e("../scene"),i=(n.createProject=function(e){for(var t=U.VE_Manager.templates(e),r=U.VE_Manager.objects(e),i=U.VE_Manager.variables(e),n=0;n<i.varData.count;n++){var a=i.varData.getVariableID(n);if("公式"!==(g=i.varData.getVariableParas(a))[0]&&"expression"!==g[0].toLowerCase())if(K.VeryVarManager.hasVarType(g[0])){var o=new X.ErrorInfo,s=K.VeryVarManager.createVariable(a,g[0],g[1],o);if(!o.isRight||null===s)return J.VE_ErrorManager.add(J.VE_Error.error(i.varData.getPos(a),"项目："+e+"，全局变量："+a+"，"+g[0]+"，"+g[1]+"，全局变量创建失败，失败原因："+o.message+"，请检查！","")),!1;i.addVariable(a,s)}else{if(!t.isCreatedTemplate(g[0]))return J.VE_ErrorManager.add(J.VE_Error.error(i.varData.getPos(a),"项目："+e+"，全局变量："+a+"，"+g[0]+"，"+g[1]+"，全局变量创建失败，当前变量不存在，请检查！","")),!1;i.addTemplate(a,t.getTemplate(g[0]).clone("__global__",a))}}for(n=0;n<i.varData.count;n++)if(a=i.varData.getVariableID(n),"公式"===(g=i.varData.getVariableParas(a))[0]||"expression"===g[0].toLowerCase()){o=new X.ErrorInfo;var u=H.VE_Expressions.createGlobalExpression(a,g[1],e,o);if(!o.isRight||!u)return J.VE_ErrorManager.add(J.VE_Error.error(i.varData.getPos(a),"项目："+e+"，全局变量："+a+","+g[0]+","+g[1]+"，全局变量创建失败，公式创建错误：\n"+o.message,"")),!1;i.addExpression(a,u)}for(n=0;n<r.count;n++)for(var p=r.getObjectID(n),c=r.getVeryObject(p),l=0;l<c.varData.count;l++)if(a=c.varData.getVariableID(l),"公式"!==(g=c.varData.getVariableParas(a))[0]&&"expression"!==g[0].toLowerCase().trim())if(K.VeryVarManager.hasVarType(g[0])){if(o=new X.ErrorInfo,null===(s=K.VeryVarManager.createVariable(a,g[0],g[1],o))||!o.isRight)return J.VE_ErrorManager.add(J.VE_Error.error(c.varData.getPos(a),"项目："+e+"，全局变量："+a+"，"+g[0]+"，"+g[1]+"，全局变量创建失败，失败原因："+o.message+"，请检查！","")),!1;i.addVariable(a,s)}else{if(!t.isCreatedTemplate(g[0]))return J.VE_ErrorManager.add(J.VE_Error.error(c.varData.getPos(a),"项目："+e+"，对象："+p+"，局部变量："+a+","+g[0]+","+g[1]+"，局部变量创建失败，当前变量不存在，请检查！","")),!1;c.addTemplate(a,t.getTemplate(g[0]).clone(p,a))}for(n=0;n<r.count;n++)for(p=r.getObjectID(n),c=r.getVeryObject(p),l=0;l<c.dataSource.fsmCount;l++){var h=c.dataSource.getFsmID(l),_=c.dataSource.getFsmData(h);if(o=new X.ErrorInfo,null===(s=K.VeryVarManager.createVariable(h,_.fsmType,_.initialValStr,o))||!o.isRight)return J.VE_ErrorManager.add(J.VE_Error.error(c.dataSource.getFsmPos(h),"项目："+e+"，对象："+p+"，状态："+h+"，状态变量初始值创建错误，错误原因："+o.message+"，请检查！","")),!1;var f=new $.VE_Fsm(e,p,h,s,c);c.addFsm(h,f)}for(n=0;n<r.count;n++)for(p=r.getObjectID(n),c=r.getVeryObject(p),l=0;l<c.varData.count;l++){var g;if(a=c.varData.getVariableID(l),"公式"===(g=c.varData.getVariableParas(a))[0]||"expression"===g[0].toLowerCase().trim()){if(o=new X.ErrorInfo,s=H.VE_Expressions.createLocalExpression(a,g[1],e,p,o),!o.isRight||!s)return J.VE_ErrorManager.add(J.VE_Error.error(c.varData.getPos(a),"项目："+e+"，对象："+p+"，局部变量："+a+","+g[0]+","+g[1]+"，局部变量创建失败，公式创建错误：\n"+o.message,"")),!1;c.addExpression(a,s)}}for(n=0;n<r.count;n++)for(p=r.getObjectID(n),c=r.getVeryObject(p),l=0;l<c.dataSource.triggerCount;l++){var d=c.dataSource.getTriggerID(l),y=c.dataSource.getTriggerPara(d);if(!ee.VE_Triggers.hasTrigger(y[0]))return J.VE_ErrorManager.add(J.VE_Error.error(c.dataSource.getTriggerPos(d),"项目："+e+"，对象："+p+"，触发："+d+"，触发类型："+y[0]+"，当前系统中不存在该触发类型，请检查！","")),!1;var m=ee.VE_Triggers.createTrigger(y[0]);c.addTrigger(d,m)}for(n=0;n<r.count;n++)for(p=r.getObjectID(n),c=r.getVeryObject(p),l=0;l<c.dataSource.actionCount;l++){var E=c.dataSource.getActionID(l),b=c.dataSource.getActionPara(E);if(!te.VE_Actions.hasAction(b[0]))return J.VE_ErrorManager.add(J.VE_Error.error(c.dataSource.getActionPos(E),"项目："+e+"，对象："+p+"，响应："+E+"，响应类型："+b[0]+"，当前系统中不存在该响应类型，请检查！","")),!1;var v=te.VE_Actions.createAction(b[0]);c.addAction(E,v)}for(n=0;n<r.count;n++)for(p=r.getObjectID(n),c=r.getVeryObject(p),l=0;l<c.dataSource.fsmCount;l++){h=c.dataSource.getFsmID(l),_=c.dataSource.getFsmData(h),f=c.getFsm(h);for(var V=0;V<_.count;V++){var T=_.getStateData(V),S=new $.VE_State(f,f.count+1);if(T.isInitialValue)S.setInitialValue(f.fsmVar.getValue());else if(!this.stateAssignment(e,p,h,i,r,c,f,T,S))return!1;if(T.isSequence&&S.setSequence(),""!==T.logicalExp){o=new X.ErrorInfo;var D=H.VE_Expressions.createFsmExpression("",T.logicalExp,e,p,h,o);if(!o.isRight||!D)return J.VE_ErrorManager.add(J.VE_Error.error("（"+T.rowIndex.toString()+"，E）","项目："+e+"，对象："+p+"，状态："+h+"，状态逻辑表达式："+T.logicalExp+"，逻辑表达式创建失败，公式创建错误：\n"+o.message,"")),!1;S.logicalAssociated=D}for(var x=0;x<T.triggerCount;x++){var O=T.getTrigger(x),C=T.getTriggerPos(x);if(null===(m=ee.VE_Triggers.findTrigger(c,O.triggerID)))return J.VE_ErrorManager.add(J.VE_Error.error(C,"项目："+e+"，对象："+p+"，状态："+h+"，触发："+O.triggerID+"，当前触发无法在系统中查找到，请检查！","")),!1;if(D=null,""!==O.logicalExp&&(o=new X.ErrorInfo,D=H.VE_Expressions.createFsmExpression("",O.logicalExp,e,p,h,o),!o.isRight||null===D))return J.VE_ErrorManager.add(J.VE_Error.error(C,"项目："+e+"，对象："+p+"，状态："+h+"，状态逻辑表达式："+O.logicalExp+"，逻辑表达式创建失败，公式创建错误：\n"+o.message,"")),!1;if(m.addTriggerTarget(D,S),""!==O.logicalSwitch){o=new X.ErrorInfo;var I=H.VE_Expressions.createFsmExpression("",O.logicalSwitch,e,p,h,o);if(!o.isRight||null===I)return J.VE_ErrorManager.add(J.VE_Error.error(C,"项目："+e+"，对象："+p+"，状态："+h+"，触发启动条件："+O.logicalSwitch+"，触发启动条件创建失败，公式创建错误：\n"+o.message,"")),!1;m.addLogicalSwitch(I)}}for(x=0;x<T.actionCount;x++){var j=T.getAction(x),P=T.getActionPos(x);if(j.type===re.StateActionType.Action){if(null===(v=te.VE_Actions.findAction(c,j.actionID)))return J.VE_ErrorManager.add(J.VE_Error.error(P,"项目："+e+"，对象："+p+"，状态："+h+"，响应："+j.actionID+"，当前响应无法在系统中查找到，请检查！","")),!1;if(o=new X.ErrorInfo,ie.VE_TypeConvert.boolConvert(j.enabled,o),!o.isRight)return J.VE_ErrorManager.add(J.VE_Error.error(P,"项目："+e+"，对象："+p+"，状态："+h+"，响应："+j.actionID+"，响应启动参数目前只允许填写bool常量true或者false，不允许填写变量，请检查！","")),!1;if(ie.VE_TypeConvert.boolConvert(j.everyFrame,o),!o.isRight)return J.VE_ErrorManager.add(J.VE_Error.error(P,"项目："+e+"，对象："+p+"，状态："+h+"，响应："+j.actionID+"，响应每帧运行参数目前只允许填写bool常量true或者false，不允许填写变量，请检查！","")),!1;if(ie.VE_TypeConvert.boolConvert(j.everyFrame,o),!o.isRight)return J.VE_ErrorManager.add(J.VE_Error.error(P,"项目："+e+"，对象："+p+"，状态："+h+"，响应："+j.actionID+"，响应动画顺序运行参数目前只允许填写bool常量true或者false，不允许填写变量，请检查！","")),!1;var w=new $.VE_StateAction;w.setAction(v),S.addAction(w)}else if(!this.assignmentAction(e,p,h,i,r,c,j,S))return!1}if(f.isCreatedState(T.stateIndex))return J.VE_ErrorManager.add(J.VE_Error.error("（"+T.rowIndex.toString()+"，I）","项目："+e+"，对象："+p+"，状态："+h+"，状态赋值："+T.ValStr+"，当前关联ID已创建，请勿重复创建！","")),!1;f.addState(S,T.stateIndex)}}for(n=0;n<r.count;n++)for(p=r.getObjectID(n),c=r.getVeryObject(p),l=0;l<c.dataSource.fsmCount;l++)for(h=c.dataSource.getFsmID(l),_=c.dataSource.getFsmData(h),f=c.getFsm(h),V=0;V<_.count;V++)for(T=_.getStateData(V),S=f.getState(V),x=0;x<T.associatedStateCount;x++){for(var A=T.getAssociatedState(x),M=T.getAssociatedStatePos(x),F=new $.VE_AssociatedState(S),N=A.split(/,|，/),L=0;L<N.length;L++){A=N[L].trim();var k=$.StateConst.STATE_INDEX,R=A.split("=");if(1===R.length)k=$.StateConst.STATE_INDEX;else{if(2!==R.length)return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态格式错误，应为“状态名=子状态ID（整数）”的形式，请检查！","")),!1;if(o=new X.ErrorInfo,k=ie.VE_TypeConvert.intConvert(R[1].trim(),o),!o.isRight)return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态格式错误，应为“状态名=子状态ID（整数）”的形式，请检查！","")),!1}var B=R[0].trim();if(-1<B.indexOf($.StateConst.STATE_SEPARATOR)){for(var z=B.split($.StateConst.STATE_SEPARATOR),W=0;W<z.length;W++)z[W]=z[W].trim();if(3===z.length){if(!r.isCreated(z[0]))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“对象名.*模板变量.状态名”，无法查找到该对象，请检查！","")),!1;var G=r.getVeryObject(z[0]);if(!z[1].startsWith($.StateConst.VARIABLE_SYMBOL))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“对象名.*模板变量.状态名”，模板变量填写格式不正确，请检查！","")),!1;if(a=z[1].substring(1),!G.isCreatedTemplate(a))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“对象名.*模板变量.状态名”，在当前对象中无法查找到该模板变量，请检查！","")),!1;if(!(Y=G.getTemplate(a)).dataSource.isCreatedFsm(z[2]))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“对象名.*模板变量.状态名”，在当前对象的该模板变量中无法查找到对应状态名，请检查！","")),!1;F.addTemplate(Y,z[2],k)}else{if(2!==z.length)return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，状态名填写错误，无法查找到对应状态，请检查！","")),!1;var q=z[0].trim();if(B=z[1].trim(),q.startsWith($.StateConst.VARIABLE_SYMBOL))if(q=q.substring(1),c.isCreatedTemplate(q)){if(!(Y=c.getTemplate(q)).dataSource.isCreatedFsm(z[1]))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“*模板变量.状态名”，在当前模板变量中无法查找到对应状态名，请检查！","")),!1;F.addTemplate(Y,z[1],k)}else{if(!i.isCreatedTemplate(q))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“*模板变量.状态名”，在当前系统中无法查找到该模板变量，请检查！","")),!1;var Y;if(!(Y=i.getTemplate(q)).dataSource.isCreatedFsm(z[1]))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“*模板变量.状态名”，在当前模板变量中无法查找到对应状态名，请检查！","")),!1;F.addTemplate(Y,z[1],k)}else{if(null===(G=r.getVeryObject(q)))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“对象名.状态名”，当前系统中无法查找到该对象名，请检查！","")),!1;if(null===(Q=G.getFsm(B)))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“对象名.状态名”，当前对象名所对应的对象中无法查找到该状态名，请检查！","")),!1;if(null===(Z=Q.getState(k)))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，当前关联状态填写格式为“对象名.状态名”，当前关联状态序号超出对应状态序号范围，请检查！","")),!1;F.add(Z,k)}}}else{var Q,Z;if(null===(Q=c.getFsm(B)))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，状态名填写错误，可以查找到对象，但是对象上无法查找到该状态，请检查！","")),!1;if(null===(Z=Q.getState(k)))return J.VE_ErrorManager.add(J.VE_Error.error(M,"项目："+e+"，对象："+p+"，状态："+h+"，关联状态："+A+"，状态名填写错误，可以查找到对象和状态，但是状态序号超出范围，请检查！","")),!1;F.add(Z,k)}}S.addAssociatedState(F)}return!0},n.stateAssignment=function(e,t,r,i,n,a,o,s,u){var p=s.ValStr;if(-1<p.indexOf($.StateConst.VARIABLE_SYMBOL))if(-1<p.indexOf($.StateConst.STATE_SEPARATOR)){for(var c=p.split($.StateConst.STATE_SEPARATOR),l=0;l<c.length;l++)c[l]=c[l].trim();if(2===c.length){if(!c[1].startsWith($.StateConst.VARIABLE_SYMBOL))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，状态赋值变量格式错误，应为“（1）*变量；（2）对象名.*变量；（3）*模板变量.*变量；（4）对象名.*模板变量.*变量”几种形式，当前不符合，无法解析，请检查！","")),!1;if(c[0].startsWith($.StateConst.VARIABLE_SYMBOL)){var h=c[0].substring(1),_=c[1].substring(1);if(a.isCreatedTemplate(h)){if(!(d=a.getTemplate(h)).varData.isCreatedVariable(_)&&!d.dataSource.isCreatedFsm(_))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“*模板变量.*变量”，当前“*模板变量”可以查找到，但是无法查到对应“*变量”，请检查！","")),!1;u.setTemplateInfo(d,_,p)}else{if(!i.isCreatedTemplate(h))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“*模板变量.*变量”，当前“*模板变量”无法在系统中查找到，请检查！","")),!1;if(!(d=i.getTemplate(h)).varData.isCreatedVariable(_)&&!d.dataSource.isCreatedFsm(_))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“*模板变量.*变量”，当前“*模板变量”可以查找到，但是无法查到对应“*变量”，请检查！","")),!1;u.setTemplateInfo(d,_,p)}}else{if(c[0]===t&&c[1].substring(1)===r)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“对象名.*变量”，状态变量赋值不能自己赋值给自己，请检查！","")),!1;var f=new X.ErrorInfo,g=K.VeryVarManager.getVariable(c[1].substring(1),e,c[0],f);if(!f.isRight||null===g)return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“对象名.*变量”，*变量："+c[1]+"无法在系统中查找到，错误信息："+f,"")),!1;if(!D.VE_AssignmentTypeJudge.allow(o.fsmVar,g))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“对象名.*变量”，变量类型与状态类型不匹配，不能赋值，请检查！","")),!1;u.setStateVariable(g)}}else{if(3!==c.length)return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，状态赋值变量格式错误，应为“（1）*变量；（2）对象名.*变量；（3）*模板变量.*变量；（4）对象名.*模板变量.*变量”几种形式，当前不符合，无法解析，请检查！","")),!1;if(c[0].startsWith($.StateConst.STATE_SEPARATOR)||!c[1].startsWith($.StateConst.STATE_SEPARATOR)||!c[2].startsWith($.StateConst.STATE_SEPARATOR))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，状态赋值变量格式错误，应为“（1）*变量；（2）对象名.*变量；（3）*模板变量.*变量；（4）对象名.*模板变量.*变量”几种形式，当前不符合，无法解析，请检查！","")),!1;if(h=c[1].substring(1),_=c[2].substring(1),!n.isCreated(c[0]))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“对象名.*模板变量.*变量”，当前“对象名”无法在系统中查找到，请检查！","")),!1;var d,y=n.getVeryObject(c[0]);if(!y.isCreatedTemplate(h))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“对象名.*模板变量.*变量”，当前“对象名”的对象中无法查找到该“*模板变量”，请检查！","")),!1;if(!(d=y.getTemplate(h)).varData.isCreatedVariable(_)&&!d.dataSource.isCreatedFsm(_))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“对象名.*模板变量.*变量”，当前“对象名.*模板变量”可以查找到，但是无法查到对应“*变量”，请检查！","")),!1;u.setTemplateInfo(d,_,p)}}else{if((_=p.substring(1))==r)return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“*变量”，状态变量赋值不能自己赋值给自己，请检查！","")),!1;f=new X.ErrorInfo;var m=K.VeryVarManager.getVariable(_,e,t,f);if(null===m)return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，状态赋值变量无法在当前系统中查找到，错误信息："+f,"")),!1;if(!D.VE_AssignmentTypeJudge.allow(o.fsmVar,m))return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，当前赋值格式“*变量”，变量类型与状态类型不匹配，不能赋值，请检查！","")),!1;u.setStateVariable(m)}else{f=new X.ErrorInfo;var E=o.fsmVar.initValue(p,f);if(!f.isRight)return J.VE_ErrorManager.add(J.VE_Error.error("（"+s.rowIndex+"，F）","项目："+e+"，对象："+t+"，状态："+r+"，状态赋值："+s.ValStr+"，状态赋值常量转化错误，请检查！","")),!1;u.setConstValue(E)}return!0},n.assignmentAction=function(e,t,r,i,n,a,o,s){var u=new te.VE_Assignment(s,o.totalString),p=o.varID;if(!(-1<p.indexOf($.StateConst.VARIABLE_SYMBOL)))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号左边必须为变量，请检查！","")),!1;if(-1<p.indexOf($.StateConst.STATE_SEPARATOR)){for(var c=p.split($.StateConst.STATE_SEPARATOR),l=0;l<c.length;l++)c[l]=c[l].trim();if(2===c.length)if(c[0].startsWith($.StateConst.VARIABLE_SYMBOL)){var h=c[0].substring(1);if(p=c[1].substring(1),a.isCreatedTemplate(h))if((d=a.getTemplate(h)).varData.isCreatedVariable(p)){if("expression"===(_=d.varData.getVariableParas(p))[1].toLowerCase()||"公式"===_[1].toLowerCase())return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“*模板变量.*变量”，该变量不能为“公式”，请检查！","")),!1;u.setLeftTemplateVar(d,p)}else{if(!d.dataSource.isCreatedFsm(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“*模板变量.*变量”，当前“*模板变量”可以查找到，但是无法查到对应“*变量”，请检查！","")),!1;u.setLeftTemplateVar(d,p)}else{if(!i.isCreatedTemplate(h))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“*模板变量.*变量”，当前“*模板变量”无法在系统中查找到，请检查！","")),!1;if((d=i.getTemplate(h)).varData.isCreatedVariable(p)){var _;if("expression"===(_=d.varData.getVariableParas(p))[1].toLowerCase()||"公式"===_[1].toLowerCase())return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“*模板变量.*变量”，该变量不能为“公式”，请检查！","")),!1;u.setLeftTemplateVar(d,p)}else{if(!d.dataSource.isCreatedFsm(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“*模板变量.*变量”，当前“*模板变量”可以查找到，但是无法查到对应“*变量”，请检查！","")),!1;u.setLeftTemplateVar(d,p)}}}else{if(!n.isCreated(c[0]))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号左侧变量格式“对象名.*变量”，当前“对象名”无法在系统中查找到，请检查！","")),!1;var f=n.getVeryObject(c[0]);if(p=p.substring(1),f.isCreatedExpression(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“对象名.*变量”，该变量不能为“公式”，请检查！","")),!1;if(f.isCreatedFsm(p)){var g=f.getFsm(p).fsmVar;u.setLeftVariable(g)}else if(f.isCreatedVariable(p))g=f.getVariable(p),u.setLeftVariable(g);else{if(!f.isCreatedTemplate(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“对象名.*变量”，无法在当前对象名中查找到该变量，请检查！","")),!1;var d=f.getTemplate(p);u.setLeftTemplate(d)}}else{if(3!==c.length)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号左侧变量格式错误，应为“（1）*变量；（2）对象名.*变量；（3）*模板变量.*变量；（4）对象名.*模板变量.*变量”几种形式，当前不符合，无法解析，请检查！","")),!1;if(c[0].startsWith($.StateConst.STATE_SEPARATOR)||!c[1].startsWith($.StateConst.STATE_SEPARATOR)||!c[2].startsWith($.StateConst.STATE_SEPARATOR))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号左侧变量格式错误，应为“（1）*变量；（2）对象名.*变量；（3）*模板变量.*变量；（4）对象名.*模板变量.*变量”几种形式，当前不符合，无法解析，请检查！","")),!1;if(h=c[1].substring(1),p=c[2].substring(1),!n.isCreated(c[0]))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号左侧变量格式“对象名.*模板变量.*变量”，当前“对象名”无法在系统中查找到，请检查！","")),!1;if(!(V=n.getVeryObject(c[0])).isCreatedTemplate(h))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号左侧变量格式“对象名.*模板变量.*变量”，当前“对象名”的对象中无法查找到该“*模板变量”，请检查！","")),!1;if((d=V.getTemplate(h)).dataSource.isCreatedFsm(p))u.setLeftTemplateVar(d,p);else{if(!d.varData.isCreatedVariable(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号左侧变量格式“对象名.*模板变量.*变量”，当前“对象名.*模板变量”可以查找到，但是无法查到对应“*变量”，请检查！","")),!1;var y=d.varData.getVariableParas(p);if("expression"===y[1].toLowerCase()||"公式"===y[1].toLowerCase())return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号左侧变量格式“对象名.*模板变量.*变量”，当前“对象名.*模板变量.*变量”为公式变量，公式变量不可直接赋值，请检查！","")),!1;u.setLeftTemplateVar(d,p)}}}else{if(p=p.substring(1),a.isCreatedExpression(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“*变量”，该变量不能为“公式”，请检查！","")),!1;if(a.isCreatedFsm(p))g=a.getFsm(p).fsmVar,u.setLeftVariable(g);else if(a.isCreatedVariable(p))g=a.getVariable(p),u.setLeftVariable(g);else if(a.isCreatedTemplate(p))d=a.getTemplate(p),u.setLeftTemplate(d);else{if(i.isCreatedExpression(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“*变量”，该变量不能为“公式”，请检查！","")),!1;if(i.isCreatedVariable(p))g=i.getVariable(p),u.setLeftVariable(g);else{if(!i.isCreatedTemplate(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧格式“*变量”，无法在当前系统中查找到该变量，请检查！","")),!1;d=i.getTemplate(p),u.setLeftTemplate(d)}}}if((p=o.varValue.trim()).startsWith('"')||p.startsWith("'")||p.startsWith("“")||p.startsWith("‘"))u.setRightConst(p.substring(1,p.length-2).trim());else if(X.VE_StringFormat.isFormulaString(p)){var m=new X.ErrorInfo;$.StateConst.AssignmentFormulaCount++;var E=H.VE_Expressions.createLocalExpression($.StateConst.AssignmentPrefix+$.StateConst.AssignmentFormulaCount.toString(),p,e,t,m);if(!m.isRight||!E)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号右侧格式“公式”，公式解析错误，请检查！错误信息："+m,"")),!1;u.setRightVariable(new K.VeryExpression(E))}else if(-1<p.indexOf($.StateConst.VARIABLE_SYMBOL))if(-1<p.indexOf($.StateConst.STATE_SEPARATOR)){for(c=p.split($.StateConst.STATE_SEPARATOR),l=0;l<c.length;l++)c[l]=c[l].trim();if(2===c.length)if(c[0].startsWith($.StateConst.VARIABLE_SYMBOL))if(h=c[0].substring(1),p=c[1].substring(1),a.isCreatedTemplate(h)){if(!(d=a.getTemplate(h)).varData.isCreatedVariable(p)&&!d.dataSource.isCreatedFsm(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号右侧格式“*模板变量.*变量”，当前“*模板变量”可以查找到，但是无法查到对应“*变量”，请检查！","")),!1;u.setRightTemplateVariable(d,p)}else{if(!i.isCreatedTemplate(h))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号右侧格式“*模板变量.*变量”，当前“*模板变量”无法在系统中查找到，请检查！","")),!1;if(!(d=i.getTemplate(h)).varData.isCreatedVariable(p)&&!d.dataSource.isCreatedFsm(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号右侧格式“*模板变量.*变量”，当前“*模板变量”可以查找到，但是无法查到对应“*变量”，请检查！","")),!1;u.setRightTemplateVariable(d,p)}else{if(!n.isCreated(c[0]))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号右侧变量格式“对象名.*变量”，当前“对象名”无法在系统中查找到，请检查！","")),!1;f=n.getVeryObject(c[0]),p=p.substring(1);var b=null,v=null;if(f.isCreatedExpression(p))b=new K.VeryExpression(f.getExpression(p));else if(f.isCreatedFsm(p))b=f.getFsm(p).fsmVar;else if(f.isCreatedVariable(p))b=f.getVariable(p);else{if(!f.isCreatedTemplate(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号右侧格式“对象名.*变量”，无法在当前系统中查找到该变量，请检查！","")),!1;v=f.getTemplate(p)}if(null!==b){if(u.leftType===re.AssignType.Template)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧为“模板变量”类型，右侧为“普通变量”类型，无法赋值，请检查！","")),!1;if(u.leftType===re.AssignType.Variable){if(!D.VE_AssignmentTypeJudge.allow(u.leftVariable,b))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧和右侧类型不匹配，无法赋值，请检查！","")),!1;u.setRightVariable(b)}else u.setRightVariable(b)}else{if(null==v)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号右侧数据无法识别，请检查！","")),!1;if(u.leftType!==re.AssignType.Template)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧为“模板变量”，右侧为“普通变量”，无法赋值，请检查！","")),!1;u.setRightTemplate(v)}}else{if(3!==c.length)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号右侧变量格式错误，应为“（1）*变量；（2）对象名.*变量；（3）*模板变量.*变量；（4）对象名.*模板变量.*变量”几种形式，当前不符合，无法解析，请检查！","")),!1;if(c[0].startsWith($.StateConst.STATE_SEPARATOR)||!c[1].startsWith($.StateConst.STATE_SEPARATOR)||!c[2].startsWith($.StateConst.STATE_SEPARATOR))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号右侧变量格式错误，应为“（1）*变量；（2）对象名.*变量；（3）*模板变量.*变量；（4）对象名.*模板变量.*变量”几种形式，当前不符合，无法解析，请检查！","")),!1;var V;if(h=c[1].substring(1),p=c[2].substring(1),!n.isCreated(c[0]))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号右侧变量格式“对象名.*模板变量.*变量”，当前“对象名”无法在系统中查找到，请检查！","")),!1;if(!(V=n.getVeryObject(c[0])).isCreatedTemplate(h))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号右侧变量格式“对象名.*模板变量.*变量”，当前“对象名”的对象中无法查找到该“*模板变量”，请检查！","")),!1;if(!(d=V.getTemplate(h)).dataSource.isCreatedFsm(p)&&!d.varData.isCreatedVariable(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，赋值响应等号右侧变量格式“对象名.*模板变量.*变量”，当前“对象名.*模板变量”可以查找到，但是无法查到对应“*变量”，请检查！","")),!1;u.setRightTemplateVariable(d,p)}}else{if(p=p.substring(1),v=b=null,a.isCreatedExpression(p))b=new K.VeryExpression(a.getExpression(p));else if(a.isCreatedFsm(p))b=a.getFsm(p).fsmVar;else if(a.isCreatedVariable(p))b=a.getVariable(p);else if(a.isCreatedTemplate(p))v=a.getTemplate(p);else if(i.isCreatedExpression(p))b=new K.VeryExpression(i.getExpression(p));else if(i.isCreatedVariable(p))b=i.getVariable(p);else if(i.isCreatedTemplate(p))v=i.getTemplate(p);else if(x.VerySceneVariables.Variables.isCreatedExpression(p))b=new K.VeryExpression(x.VerySceneVariables.Variables.getExpression(p));else{if(!x.VerySceneVariables.Variables.isCreatedVariable(p))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号右侧格式“*变量”，无法在当前系统中查找到该变量，请检查！","")),!1;b=x.VerySceneVariables.Variables.getVariable(p)}if(null!=b){if(u.leftType===re.AssignType.Template)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧为“模板变量”类型，右侧为“普通变量”类型，无法赋值，请检查！","")),!1;if(u.leftType===re.AssignType.Variable){if(!D.VE_AssignmentTypeJudge.allow(u.leftVariable,b))return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧和右侧类型不匹配，无法赋值，请检查！","")),!1;u.setRightVariable(b)}else u.setRightVariable(b)}else{if(null==v)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号右侧数据无法识别，请检查！","")),!1;if(u.leftType!==re.AssignType.Template)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧为“模板变量”，右侧为“普通变量”，无法赋值，请检查！","")),!1;u.setRightTemplate(v)}}else if(u.leftType===re.AssignType.Template){if("null"!==p.trim().toLowerCase())return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧为模板变量，右侧赋值为常量时只能填“null”，表示销毁模板变量，当前格式错误，请检查！","")),!1;u.setRightNull()}else if(u.leftType===re.AssignType.TemplateVariable)u.setRightConst(p);else{if(null===u.leftVariable)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧变量获取为空，请检查！","")),!1;m=new X.ErrorInfo;var T=u.leftVariable.initValue(p,m);if(!m.isRight||!T)return J.VE_ErrorManager.add(J.VE_Error.error("","项目："+e+"，对象："+t+"，状态："+r+"，赋值响应："+o.totalString+"，当前赋值响应等号左侧变量类型与右侧常量值不匹配，错误信息："+m+"，请检查！","")),!1;u.setRightConstValue(T)}var S=new $.VE_StateAction;return S.setAssignment(u),s.addAction(S),!0},n.createInstance=function(e,t,r,i,n,a,o){return i},n);function n(){}r.CreateInstance=i},{"../action":7,"../action/assignmentTypeJudge":6,"../enum":17,"../expression":26,"../global":37,"../manager":49,"../scene":56,"../state":60,"../trigger":67,"../utility":73,"../utility/typeConvert":75,"../variables":77}],47:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./loaderManager")),i(e("./createInstance"))},{"./createInstance":46,"./loaderManager":48}],48:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var P,i,w=e("../template"),A=e("../object"),M=e("../dataSource"),F=e("../manager"),N=e("../variables"),L=e("../utility"),k=e("../global"),R=e("../state"),B=e("./createInstance");(i=P=r.AnalisysType||(r.AnalisysType={}))[i.Global=0]="Global",i[i.Object=1]="Object",i[i.Template=2]="Template";var n=(a.prototype.load=function(e,t){this._projectName=e,this._table=t,F.VE_Manager.createProject(e);var r=F.VE_Manager.templates(e),i=F.VE_Manager.objects(e),n=F.VE_Manager.variables(e);if(t){for(var a=1;a<t.RowCount;a++)if(!t.getData(a,0).startsWith("//")&&!t.getRow(a).isEmpty())if(t.getData(a,0).startsWith("模板_")){this._activeFsmData=null,this._activeStateData=null,this._currentType=P.Template;var o=t.getData(a,0).replace(" ","").substring(3);if(-1<o.indexOf(":")||-1<o.indexOf("："));else{if(!L.VE_StringFormat.isIDLegal(o))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,0),"模板对象名："+t.getData(a,0)+"，当前模板对象名不合法，包含非法字符，请检查！",t.ID)),!1;if(r.isCreatedTemplate(o))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,0),"模板对象名："+t.getData(a,0)+"，当前模板已创建，请勿使用重复的模板对象名！",t.ID)),!1;var s=new w.VE_Template(e,o);r.addTemplate(o,s),this._activeTemplate=s}}else if(""!==t.getData(a,0)){this._activeFsmData=null,this._activeStateData=null,this._currentType=P.Object;var u=t.getData(a,0),p="";if(-1<u.indexOf("=")){var c=u.split("=");if(2!==c.length)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,0),"对象名："+t.getData(a,0)+"，当前对象名格式错误，应为“对象名”或者“对象名=场景物体名”的形式，请检查！",t.ID)),!1;u=c[0].trim(),p=c[1].trim()}if(!L.VE_StringFormat.isIDLegal(u))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,0),"对象名："+t.getData(a,0)+"，当前对象名不合法，包含非法字符，请检查！",t.ID)),!1;var l=null;if(""===p)l=new N.GameObject("__"+u+"_Empty");else if(null===(l=N.GameObject.find(p)))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,0),"对象名："+p+"，当前对象在场景中不存在，请检查！",t.ID)),!1;if(i.isCreated(u))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,0),"对象名："+t.getData(a,0)+"，当前对象已创建，请勿使用重复的对象名！",t.ID)),!1;var h=new A.VeryEngineObject(e,u,l);i.add(u,h),this._activeObject=h}else if(""!==t.getData(a,5)&&""===t.getData(a,1)&&""===t.getData(a,2)&&""===t.getData(a,3)&&""===t.getData(a,4)&&""===t.getData(a,6)&&""===t.getData(a,7)&&""===t.getData(a,8)){var _=t.getData(a,5);if(this._currentType===P.Global){if(2!==(V=L.VE_StringFormat.paraSegment(_)).length&&3!==V.length)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"全局变量："+t.getData(a,5)+"，当前全局变量格式不正确，请检查！",t.ID)),!1;var f=V[0].trim();if(!L.VE_StringFormat.isIDLegal(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"全局变量："+t.getData(a,5)+"，当前变量名不合法，包含非法字符，请检查！",t.ID)),!1;var g=[V[1].trim()];if(2===V.length?g[1]="":g[1]=V[2].trim(),n.varData.isCreatedVariable(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"全局变量："+t.getData(a,5)+"，当前全局变量名已创建，请检查！",t.ID)),!1;n.varData.addVariable(f,g,t.pos(a,5))}else if(-1<_.indexOf("="))if(2===(g=_.split("=")).length&&g[0].trim()===this._lastFsmID){if(null===this._activeFsmData)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态赋值："+t.getData(a,5)+"，当前状态不属于任何对象和模板对象，请检查！",t.ID)),!1;var d=g[1].trim().split(/,|，/),y=R.StateConst.STATE_INDEX,m=null;if(2===d.length){if(d[0]=d[0].trim(),d[1]=d[1].trim(),!d[1].startsWith("#"))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态赋值："+t.getData(a,5)+"，状态关联ID格式错误，状态关联标志ID写法：“状态ID=赋值，#整数ID”，请检查！",t.ID)),!1;if(NaN===(y=parseInt(d[1].substring(1))))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态赋值："+t.getData(a,5)+"，状态关联ID格式错误，状态关联标志ID写法：“状态ID=赋值，#整数ID”，当前整数转化错误！",t.ID)),!1}(m=new M.VE_StateData(this._activeFsmData,d[0].trim(),!1,y)).rowIndex=a,this._activeFsmData.addState(m),this._activeStateData=m}else{if(3!==(V=L.VE_StringFormat.paraSegment(_)).length)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"局部公式变量："+t.getData(a,5)+"，当前局部公式变量格式不正确，请检查！",t.ID)),!1;if(f=V[0].trim(),!L.VE_StringFormat.isIDLegal(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"变量："+t.getData(a,5)+"，当前变量名不合法，包含非法字符，请检查！",t.ID)),!1;var E=[V[1].trim(),V[2].trim()];if(this._currentType===P.Object){if(this._activeObject.varData.isCreatedVariable(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"对象名："+this._activeObject.objectID+"，局部变量："+t.getData(a,5)+"，当前局部变量名已创建，请检查！",t.ID)),!1;if(this._activeObject.dataSource.isCreatedFsm(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"对象名："+this._activeObject.objectID+"，局部变量："+t.getData(a,5)+"，局部变量名不能与状态名相同，当前状态已创建，请检查！",t.ID)),!1;this._activeObject.varData.addVariable(f,E,t.pos(a,5))}else{if(this._currentType!==P.Template)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"局部变量："+t.getData(a,5)+"，当前局部变量所属未知，格式错误，请检查！",t.ID)),!1;if(this._activeTemplate.varData.isCreatedVariable(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"模板对象名："+this._activeTemplate.templateID+"，局部变量："+t.getData(a,5)+"，当前局部变量名已创建，请检查！",t.ID)),!1;if(this._activeTemplate.dataSource.isCreatedFsm(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"模板对象名："+t.getData(a,5)+"，当前局部变量所属未知，格式错误，请检查！",t.ID)),!1;this._activeTemplate.varData.addVariable(f,E,t.pos(a,5))}}else{if(2!==(V=L.VE_StringFormat.paraSegment(_)).length&&3!==V.length)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"局部变量："+t.getData(a,5)+"，当前局部变量格式不正确，请检查！",t.ID)),!1;if(f=V[0].trim(),!L.VE_StringFormat.isIDLegal(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"变量："+t.getData(a,5)+"，当前变量名不合法，包含非法字符，请检查！",t.ID)),!1;if(g=[V[1].trim()],2===V.length?g[1]="":g[1]=V[2].trim(),this._currentType===P.Object){if(this._activeObject.varData.isCreatedVariable(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"对象名："+this._activeObject.objectID+"，局部变量："+t.getData(a,5)+"，当前局部变量名已创建，请检查！",t.ID)),!1;if(this._activeObject.dataSource.isCreatedFsm(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"对象名："+this._activeObject.objectID+"，局部变量："+t.getData(a,5)+"，局部变量名不能与状态名相同，当前状态已创建，请检查！",t.ID)),!1;this._activeObject.varData.addVariable(f,g,t.pos(a,5))}else{if(this._currentType!==P.Template)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"局部变量："+t.getData(a,5)+"，当前局部变量所属未知，格式错误，请检查！",t.ID)),!1;if(this._activeTemplate.varData.isCreatedVariable(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"模板对象名："+this._activeTemplate.templateID+"，局部变量："+t.getData(a,5)+"，当前局部变量名已创建，请检查！",t.ID)),!1;if(this._activeTemplate.dataSource.isCreatedFsm(f))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"模板对象名："+this._activeTemplate.templateID+"，局部变量："+t.getData(a,5)+"，局部变量名不能与状态名相同，当前状态已创建，请检查！",t.ID)),!1;this._activeTemplate.varData.addVariable(f,g,t.pos(a,5))}}}else{if(""!==t.getData(a,5))if(-1<(_=t.getData(a,5)).indexOf("=")){var b=_.split("="),v=b[0].trim();if(2!==b.length||v!==this._lastFsmID)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态赋值："+t.getData(a,5)+"，状态名："+v+"，当前状态未定义，请检查！",t.ID)),!1;if(null===this._activeFsmData)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态赋值："+t.getData(a,5)+"，当前状态不属于任何对象和模板对象，请检查！",t.ID)),!1;if(d=b[1].trim().split(/,|，/),y=R.StateConst.STATE_INDEX,m=null,2===d.length){if(d[0]=d[0].trim(),d[1]=d[1].trim(),!d[1].startsWith("#"))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态赋值："+t.getData(a,5)+"，状态关联ID格式错误，状态关联标志ID写法：“状态ID=赋值，#整数ID”，请检查！",t.ID)),!1;if(NaN===(y=parseInt(d[1].substring(1))))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态赋值："+t.getData(a,5)+"，状态关联ID格式错误，状态关联标志ID写法：“状态ID=赋值，#整数ID”，当前整数转化错误！",t.ID)),!1}(m=new M.VE_StateData(this._activeFsmData,d[0].trim(),!1,y)).rowIndex=a,this._activeFsmData.addState(m),this._activeStateData=m}else{var V;if(2!==(V=L.VE_StringFormat.paraSegment(_)).length&&3!==V.length&&4!==V.length)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态："+t.getData(a,5)+"，当前状态格式不正确，应为“状态名，类型，初始值”的形式，请检查！",t.ID)),!1;if(v=V[0].trim(),!L.VE_StringFormat.isIDLegal(v))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态名："+t.getData(a,5)+"，当前状态名不合法，包含非法字符，请检查！",t.ID)),!1;if(this._lastFsmID=v,g=[V[1].trim()],2===V.length?g[1]="":g[1]=V[2].trim(),y=R.StateConst.STATE_INDEX,4===V.length){if(!V[3].startsWith("#"))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态赋值："+V[3]+"，状态关联ID格式错误，状态关联标志ID写法：“状态ID，变量类型，变量值，#整数ID”，当前整数转化错误！",t.ID)),!1;if(NaN===(y=parseInt(V[3].substring(1))))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"状态赋值："+V[3]+"，状态关联ID格式错误，状态关联标志ID写法：“状态ID，变量类型，变量值，#整数ID”，当前整数转化错误！",t.ID)),!1}if(this._currentType===P.Object){if(this._activeObject.varData.isCreatedVariable(v))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"对象名："+this._activeObject.objectID+"，状态名："+v+"，状态名与局部变量名不能相同，当前局部变量已创建，请检查！",t.ID)),!1;if(this._activeObject.dataSource.isCreatedFsm(v))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"对象名："+this._activeObject.objectID+"，状态名："+v+"，当前状态已创建，请检查！",t.ID)),!1;if(this._activeObject.dataSource.createFsm(v,t.pos(a,5)),this._activeFsmData=this._activeObject.dataSource.getFsmData(v),!N.VeryVarManager.hasVarType(g[0]))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"对象名："+this._activeObject.objectID+"，状态名："+v+"，类型："+g[0]+"，状态类型错误，当前状态变量类型在系统中不存在，请检查！",t.ID)),!1;this._activeFsmData.initFsm(g[0],g[1]),(m=new M.VE_StateData(this._activeFsmData,g[1],!0,y)).rowIndex=a,this._activeFsmData.addState(m),this._activeStateData=m}else{if(this._currentType!==P.Template)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"局部变量："+t.getData(a,5)+"，当前局部变量所属未知，格式错误，请检查！",t.ID)),!1;if(this._activeTemplate.varData.isCreatedVariable(v))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"模板对象名："+this._activeTemplate.templateID+"，状态名："+v+"，状态名与局部变量名不能相同，当前局部变量已创建，请检查！",t.ID)),!1;if(this._activeTemplate.dataSource.isCreatedFsm(v))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"模板对象名："+this._activeTemplate.templateID+"，状态名："+v+"，当前状态已创建，请检查！",t.ID)),!1;if(this._activeTemplate.dataSource.createFsm(v,t.pos(a,5)),this._activeFsmData=this._activeTemplate.dataSource.getFsmData(v),!N.VeryVarManager.hasVarType(g[0]))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,5),"模板对象名："+this._activeTemplate.objectID+"，状态名："+v+"，类型："+g[0]+"，状态类型错误，当前状态变量类型在系统中不存在，请检查！",t.ID)),!1;this._activeFsmData.initFsm(g[0],g[1]),(m=new M.VE_StateData(this._activeFsmData,g[1],!0,y)).rowIndex=a,this._activeFsmData.addState(m),this._activeStateData=m}}if(""!==t.getData(a,2)){if(null===this._activeFsmData||null===this._activeStateData)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,2),"触发："+t.getData(a,2)+"，当前触发不属于任何对象和模板对象，请检查！",t.ID)),!1;var T=t.getData(a,2);if(!L.VE_StringFormat.isIDLegal(T))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,2),"触发名："+t.getData(a,2)+"，当前触发名不合法，包含非法字符，请检查！",t.ID)),!1;if(""!==t.getData(a,3)){if(this._activeFsmData.dataSource.isCreatedTrigger(T))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,2),"触发："+t.getData(a,2)+"，当前触发已在该对象中定义，请勿重复定义，请检查！",t.ID)),!1;this._activeFsmData.dataSource.addTrigger(T,L.VE_StringFormat.paraSegment(t.getData(a,3)),t.pos(a,2))}var S=new M.VE_StateTriggerData(T);this._activeStateData.addTrigger(S,t.pos(a,2)),""!==t.getData(a,1)&&(S.logicalSwitch=t.getData(a,1)),""!==t.getData(a,4)&&(S.logicalExp=t.getData(a,4))}else{if(""!==t.getData(a,1))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,1),"触发启动条件："+t.getData(a,1)+"，当前无触发，请勿定义触发启动条件，请检查！",t.ID)),!1;if(""!==t.getData(a,4)){if(null===this._activeFsmData||null===this._activeStateData)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,4),"状态逻辑条件："+t.getData(a,4)+"，当前状态逻辑条件不属于任何对象和模板对象，请检查！",t.ID)),!1;if(""!==this._activeStateData.logicalExp)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,4),"状态逻辑条件："+t.getData(a,4)+"，在状态的某个值中，无触发的状态逻辑条件只能填写1个，作为关联状态的逻辑条件，此处为第2个，不符合规则，请检查！",t.ID)),!1;this._activeStateData.logicalExp=t.getData(a,4)}""!==t.getData(a,3)&&k.VE_ErrorManager.add(k.VE_Error.warning(t.pos(a,3),"触发参数："+t.getData(a,3)+"，该处无触发定义，但是填写了触发参数，请检查！",t.ID))}if(""!==t.getData(a,6)){if(null===this._activeFsmData||null===this._activeStateData)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,6),"响应："+t.getData(a,6)+"，当前响应不属于任何对象和模板对象，请检查！",t.ID)),!1;var D=t.getData(a,6).toLowerCase();if(D.startsWith("log(")||D.startsWith("log（")||D.startsWith("调试（")||D.startsWith("调试(")){var x=e+"___"+R.StateConst.LogCount++,O=new M.VE_StateActionData(x,"true","false");this._activeStateData.addAction(O,t.pos(a,6));var C=t.getData(a,6).substring(4);D.startsWith("调试")&&(C=t.getData(a,6).substring(3)),this._activeFsmData.dataSource.addAction(x,["调试","调试",C.substring(0,C.length-1)],["false","false"],t.pos(a,6)),""!==t.getData(a,7)&&k.VE_ErrorManager.add(k.VE_Error.warning(t.pos(a,7),"响应参数："+t.getData(a,7)+"，该处不应该再有响应定义，但是填写了响应参数，请检查！",t.ID))}else if(D.startsWith("error(")||D.startsWith("error（")||D.startsWith("错误（")||D.startsWith("错误("))x=e+"___"+R.StateConst.LogCount++,O=new M.VE_StateActionData(x,"true","false"),this._activeStateData.addAction(O,t.pos(a,6)),C=t.getData(a,6).substring(6),D.startsWith("错误")&&(C=t.getData(a,6).substring(3)),this._activeFsmData.dataSource.addAction(x,["调试","错误",C.substring(0,C.length-1)],["false","false"],t.pos(a,6)),""!==t.getData(a,7)&&k.VE_ErrorManager.add(k.VE_Error.warning(t.pos(a,7),"响应参数："+t.getData(a,7)+"，该处不应该再有响应定义，但是填写了响应参数，请检查！",t.ID));else if(D.startsWith("warn(")||D.startsWith("warn（")||D.startsWith("警告（")||D.startsWith("警告("))x=e+"___"+R.StateConst.LogCount++,O=new M.VE_StateActionData(x,"true","false"),this._activeStateData.addAction(O,t.pos(a,6)),C=t.getData(a,6).substring(5),D.startsWith("警告")&&(C=t.getData(a,6).substring(3)),this._activeFsmData.dataSource.addAction(x,["调试","警告",C.substring(0,C.length-1)],["false","false"],t.pos(a,6)),""!==t.getData(a,7)&&k.VE_ErrorManager.add(k.VE_Error.warning(t.pos(a,7),"响应参数："+t.getData(a,7)+"，该处不应该再有响应定义，但是填写了响应参数，请检查！",t.ID));else if(-1<t.getData(a,6).indexOf("=")){""!==t.getData(a,7)&&k.VE_ErrorManager.add(k.VE_Error.warning(t.pos(a,7),"响应参数："+t.getData(a,7)+"，该处不应该再有响应定义，但是填写了响应参数，请检查！",t.ID));var I=t.getData(a,6).indexOf("=");(O=new M.VE_StateActionData("")).setAssignmentAction(t.getData(a,6),t.getData(a,6).substring(0,I).trim(),t.getData(a,6).substring(I+1).trim()),this._activeStateData.addAction(O,t.pos(a,6))}else{var j=L.VE_StringFormat.paraSegment(t.getData(a,6));if(2!==j.length&&3!==j.length&&4!==j.length)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,6),"响应："+t.getData(a,6)+"，响应格式不正确，应为“响应ID，启动标志（bool），每帧运行标志（bool）”的形式，请检查！",t.ID)),!1;if(O=void 0,O=2===j.length?new M.VE_StateActionData(j[0],j[1]):3===j.length?new M.VE_StateActionData(j[0],j[1],j[2]):new M.VE_StateActionData(j[0],j[1],j[2],j[3]),this._activeStateData.addAction(O,t.pos(a,6)),""!==t.getData(a,7)){if(!L.VE_StringFormat.isIDLegal(j[0]))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,6),"响应名："+t.getData(a,6)+"，当前响应名不合法，包含非法字符，请检查！",t.ID)),!1;if(this._activeFsmData.dataSource.isCreatedAction(j[0]))return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,6),"响应："+t.getData(a,6)+"，当前响应已在该对象中定义，请勿重复定义，请检查！",t.ID)),!1;2==j.length?this._activeFsmData.dataSource.addAction(j[0],L.VE_StringFormat.paraSegment(t.getData(a,7)),[j[1],"false"],t.pos(a,6)):this._activeFsmData.dataSource.addAction(j[0],L.VE_StringFormat.paraSegment(t.getData(a,7)),[j[1],j[2]],t.pos(a,6))}}}else""!==t.getData(a,7)&&k.VE_ErrorManager.add(k.VE_Error.warning(t.pos(a,7),"响应参数："+t.getData(a,7)+"，该处无响应定义，但是填写了响应参数，请检查！",t.ID));if(""!==t.getData(a,8)){if(null===this._activeFsmData||null===this._activeStateData)return k.VE_ErrorManager.add(k.VE_Error.error(t.pos(a,8),"关联状态："+t.getData(a,8)+"，当前关联状态不属于任何对象和模板对象，请检查！",t.ID)),!1;this._activeStateData.addAssociatedState(t.getData(a,8),t.pos(a,8))}}return B.CreateInstance.createProject(e)}return k.VE_ErrorManager.add(k.VE_Error.error("","表格内容不存在，引擎无法启动！","null")),!1},a);function a(){this._currentType=P.Global,this._projectName="",this._lastFsmID="",this._activeTemplate=null,this._activeObject=null,this._activeFsmData=null,this._activeStateData=null}r.LoaderManager=n},{"../dataSource":11,"../global":37,"../manager":49,"../object":53,"../state":60,"../template":64,"../utility":73,"../variables":77,"./createInstance":46}],49:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./projects")),i(e("./manager")),i(e("./reset"))},{"./manager":50,"./projects":51,"./reset":52}],50:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./projects"),n=e("../object"),a=e("../template"),o=e("../variables"),s=(Object.defineProperty(u,"projects",{get:function(){return null===this._projects&&(this._projects=new i.VE_Projects),this._projects},enumerable:!0,configurable:!0}),u.createProject=function(e){u.projects.isCreatedObjects(e)||u.projects.addObjects(e,new n.VE_Objects(e)),u.projects.isCreatedTemplates(e)||u.projects.addTemplates(e,new a.VE_Templates(e)),u.projects.isCreatedVariables(e)||u.projects.addVariables(e,new o.VE_Variables(e))},u.globalVarData=function(e){return u.projects.isCreatedGlobals(e)||u.projects.addVariables(e,new o.VE_Variables(e)),u.projects.getGlobalVars(e)},u.templates=function(e){return u.projects.isCreatedTemplates(e)||u.projects.addTemplates(e,new a.VE_Templates(e)),u.projects.getTemplates(e)},u.variables=function(e){return u.projects.isCreatedVariables(e)||u.projects.addVariables(e,new o.VE_Variables(e)),u.projects.getVariables(e)},u.objects=function(e){return u.projects.isCreatedObjects(e)||u.projects.addObjects(e,new n.VE_Objects(e)),u.projects.getObjects(e)},u.clear=function(){this._projects=null},u.clearProject=function(e){u.clearProject(e)},u._projects=null,u);function u(){}r.VE_Manager=s},{"../object":53,"../template":64,"../variables":77,"./projects":51}],51:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.prototype.isCreatedObjects=function(e){return!!this._objects[e]},n.prototype.addObjects=function(e,t){this._objects[e]=t},n.prototype.getObjects=function(e){return this._objects[e]},n.prototype.isCreatedVariables=function(e){return!!this._variables[e]},n.prototype.addVariables=function(e,t){this._variables[e]=t},n.prototype.getVariables=function(e){return this._variables[e]},n.prototype.isCreatedTemplates=function(e){return!!this._templates[e]},n.prototype.addTemplates=function(e,t){this._templates[e]=t},n.prototype.getTemplates=function(e){return this._templates[e]},n.prototype.isCreatedGlobals=function(e){return!!this._variables[e]},n.prototype.getGlobalVars=function(e){return this._variables[e].varData},n.prototype.clear=function(){this._objects={},this._templates={},this._variables={}},n.prototype.clearPorject=function(e){delete this._objects[e],delete this._templates[e],delete this._variables[e]},n.prototype.sleep=function(){},n);function n(){this._objects={},this._variables={},this._templates={},this.projects=[]}r.VE_Projects=i},{}],52:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});function i(){}r.VE_Reset=i},{}],53:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./veryengineObject")),i(e("./objects"))},{"./objects":54,"./veryengineObject":55}],54:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../utility"),n=(Object.defineProperty(a.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"count",{get:function(){return this._objectIDs.length},enumerable:!0,configurable:!0}),a.prototype.isCreated=function(e){return!!this._objectDics[e]},a.prototype.add=function(e,t){this.isCreated(e)||(this._objectIDs.push(e),this._objectDics[e]=t)},a.prototype.getObjectID=function(e){return 0<=e&&e<this._objectIDs.length?this._objectIDs[e]:""},a.prototype.getVeryObject=function(e){return this._objectDics[e]},a.prototype.unloadObject=function(e){i.ArrayUtility.remove(this._objectIDs,e),delete this._objectDics.object_id},a.prototype.clear=function(){for(var e=0;e<this._objectIDs.length;e++){var t=this._objectDics[this._objectIDs[e]];t&&t.clear()}this._objectIDs=[],this._objectDics={}},a);function a(e){this._projectName="",this._objectIDs=[],this._objectDics={},this._projectName=e}r.VE_Objects=n},{"../utility":73}],55:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../variables"),n=e("../dataSource"),a=(Object.defineProperty(o.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"objectID",{get:function(){return this._objectID},enumerable:!0,configurable:!0}),o.prototype.isCreatedFsm=function(e){return!!this._fsms[e]},o.prototype.addFsm=function(e,t){this._fsms[e]=t},o.prototype.getFsm=function(e){return this._fsms[e]},o.prototype.isCreatedTrigger=function(e){return!!this._triggers[e]},o.prototype.addTrigger=function(e,t){this._triggers[e]=t},o.prototype.getTrigger=function(e){return this._triggers[e]},o.prototype.isCreatedAction=function(e){return!!this._actions[e]},o.prototype.addAction=function(e,t){this._actions[e]=t},o.prototype.getAction=function(e){return this._actions[e]},o.prototype.isCreatedVariable=function(e){return!!this._variables[e]},o.prototype.addVariable=function(e,t){this._variables[e]=t},o.prototype.getVariable=function(e){return this._variables[e]},o.prototype.isCreatedExpression=function(e){return!this._expressions[e]},o.prototype.addExpression=function(e,t){this._expressions[e]=t},o.prototype.getExpression=function(e){return this._expressions[e]},o.prototype.isCreatedTemplate=function(e){return!!this._templates[e]},o.prototype.addTemplate=function(e,t){this._templates[e]=t},o.prototype.getTemplate=function(e){return this._templates[e]},o.prototype.isCreatedVar=function(e){return!!(this._variables[e]||this._expressions[e]||this._templates[e])},o.prototype.unload=function(){},o.prototype.clear=function(){var t=this;this.dataSource&&this.dataSource.clear(),this.varData&&this.varData.clear(),this._variables={},this._expressions={},this._templates&&(Object.keys(this._templates).forEach(function(e){t._templates[e].clear()}),this._templates={}),this._fsms={},this._actions&&(Object.keys(this._actions).forEach(function(e){t._actions[e].destroy()}),this._actions={}),this._triggers&&(Object.keys(this._triggers).forEach(function(e){t._triggers[e].destroy()}),this._triggers={})},o);function o(e,t,r){this._projectName="",this._objectID="",this.gameObject=new i.GameObject(""),this._variables={},this._expressions={},this._actions={},this._triggers={},this._fsms={},this._templates={},this._projectName=projectName,this._objectID=t,this.gameObject=r,this.dataSource=new n.VE_DataSource(e,t,!1),this.varData=new n.VE_VariableData(e)}r.VeryEngineObject=a},{"../dataSource":11,"../variables":77}],56:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(e("./verySceneVariables"))},{"./verySceneVariables":57}],57:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../variables"),n=(Object.defineProperty(a,"Variables",{get:function(){return null===a._variables&&(a._variables=new i.VE_Variables("__scene_varibale__")),a._variables},enumerable:!0,configurable:!0}),Object.defineProperty(a,"HasLoaded",{get:function(){return this._hasLoaded},enumerable:!0,configurable:!0}),a.initIfNeeded=function(){this._hasLoaded||console.log("TODO: 场景变量下载")},a._variables=null,a._hasLoaded=!1,a);function a(){}r.VerySceneVariables=n},{"../variables":77}],58:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../enum"),i=(Object.defineProperty(a.prototype,"FromState",{get:function(){return this._fromState},enumerable:!0,configurable:!0}),a.prototype.add=function(e,t){this._types.push(n.AssociatedFsmType.Object);var r=this._types.length;this._indexs.push(r),this._numberIndex[r]=t,this._states[r]=e},a.prototype.addTemplate=function(e,t,r){this._types.push(n.AssociatedFsmType.Object);var i=this._types.length;this._indexs.push(i),this._numberIndex[i]=r,this._templates[i]=e,this._templateIDs[i]=t},a.prototype.connect=function(){},a);function a(e){this._types=[],this._indexs=[],this._numberIndex={},this._states={},this._templates={},this._templateIDs={},this._fromState=e}r.VE_AssociatedState=i},{"../enum":17}],59:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var a=e("../utility/dictionary"),i=e("../global"),n=e("./stateConst"),o=(Object.defineProperty(s.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"ID",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"objectID",{get:function(){return this._objectID},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fsmID",{get:function(){return this._fsmID},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"fsmVar",{get:function(){return this._fsmVar},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"VeryObject",{get:function(){return this._veryObject},enumerable:!0,configurable:!0}),Object.defineProperty(s.prototype,"count",{get:function(){return this._states.length},enumerable:!0,configurable:!0}),s.prototype.isCreatedState=function(e){return this._stateDics.ContainsKey(e)},s.prototype.addState=function(e,t){this._stateDics.ContainsKey(t)||(this._stateDics.Add(t,e),this._states.push(e))},s.prototype.getState=function(e){return this._stateDics.GetValue(e)},s.prototype.removeState=function(e){return!!this.isCreatedState(e)&&(this._stateDics.Remove(e),!0)},s.prototype.receiveEvent=function(e){return i.Time.frameCount!=this._frameCount?(this._frameCount=i.Time.frameCount,this._triggerIDs=[],this._triggerIDs.push(e),!0):!!e.startsWith(n.StateConst.ASSOCIATED_STATE_PREFIX)||-1===this._triggerIDs.indexOf(e)&&(this._triggerIDs.push(e),!0)},s);function s(e,t,r,i,n){this._projectName="",this._id="",this._objectID="",this._fsmID="",this._stateDics=new a.Dictionary,this._states=[],this._frameCount=-1,this._triggerIDs=[],this._projectName=e,this._objectID=t,this._fsmID=r,this._fsmVar=i,this._veryObject=n}r.VE_Fsm=o},{"../global":37,"../utility/dictionary":71,"./stateConst":63}],60:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./state")),i(e("./fsm")),i(e("./stateAction")),i(e("./associatedState")),i(e("./stateConst"))},{"./associatedState":58,"./fsm":59,"./state":61,"./stateAction":62,"./stateConst":63}],61:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./stateAction"),n=e("../enum"),a=(Object.defineProperty(o.prototype,"Fsm",{get:function(){return this._fsm},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isInitialValue",{get:function(){return this._isInitialValue},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Value",{get:function(){return this._value},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"isTemplateVar",{get:function(){return this._isTemplateVar},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"logicalExpression",{get:function(){return this._logicalExpression},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"index",{get:function(){return this._index},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"stateVariable",{get:function(){return this._stateVariable},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"IsSequence",{get:function(){return this._isSequence},enumerable:!0,configurable:!0}),o.prototype.setInitialValue=function(e){this._value=e,this._assignmentType=n.AssignmentType.Const},o.prototype.setSequence=function(){this._isSequence=!0},o.prototype.setLogicalExpression=function(e){this._logicalExpression=e},o.prototype.setTemplateInfo=function(e,t,r){this._isTemplateVar=!0,this._template=e,this._varID=t,this._assignmentStr=r},o.prototype.setConstValue=function(e){this._value=e,this._assignmentType=n.AssignmentType.Const},o.prototype.setStateVariable=function(e){this._stateVariable=e,this._assignmentType=n.AssignmentType.Variable},o.prototype.addAction=function(e){this._stateActions.push(e),e.type===n.StateActionType.Action&&e.action.isSequence&&(this._isSequence=!0)},o.prototype.addAssignment=function(e){var t=new i.VE_StateAction;t.setAssignment(e),this._stateActions.push(t)},o.prototype.addAssociatedState=function(e){this._assocaitedStates.push(e)},o.prototype.action=function(e){this._fsm.receiveEvent(e)},o);function o(e,t){this._isInitialValue=!1,this._value="",this._assignmentType=n.AssignmentType.Const,this._isTemplateVar=!1,this._template=null,this._varID="",this._templateVar=null,this._assignmentStr="",this._logicalExpression=null,this._index=0,this._stateVariable=null,this.logicalAssociated=null,this._stateActions=[],this._assocaitedStates=[],this._isSequence=!1,this.sequenceActions=null,this._fsm=e,this._index=t}r.VE_State=a},{"../enum":17,"./stateAction":62}],62:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../enum"),n=(Object.defineProperty(a.prototype,"type",{get:function(){return this._type},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"action",{get:function(){return this._action},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"enabled",{get:function(){return this._enabled},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"everyFrame",{get:function(){return this._everyFrame},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"assignment",{get:function(){return this._assignment},enumerable:!0,configurable:!0}),a.prototype.setAction=function(e,t,r,i){void 0===t&&(t=!1),void 0===r&&(r=!1),void 0===i&&(i=!1),this._action=e,this._enabled=t,this._everyFrame=r,this._action.isSequence=i},a.prototype.setAssignment=function(e){this._assignment=e},a);function a(){this._type=i.StateActionType.Action,this._action=null,this._enabled=!1,this._everyFrame=!1,this._assignment=null}r.VE_StateAction=n},{"../enum":17}],63:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.STATE_SEPARATOR=".",n.ASSOCIATED_STATE_PREFIX="Associated_State:",n.VARIABLE_SYMBOL="*",n.STATE_INDEX=-1,n.LogCount=-1,n.AssignmentPrefix="AssignmentFormula_",n.AssignmentFormulaCount=0,n);function n(){}r.StateConst=i},{}],64:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./template")),i(e("./templates"))},{"./template":65,"./templates":66}],65:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../dataSource"),n=(Object.defineProperty(a.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"templateID",{get:function(){return this._templateID},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"templateVarID",{get:function(){return this._templateVarID},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"objectID",{get:function(){return this._objectID},enumerable:!0,configurable:!0}),a.prototype.instanceCount=function(){return this._instanceCount},a.prototype.setInstance=function(e){this.templateInstance=e},a.prototype.isCreatedVariable=function(e){return this.varData.isCreatedVariable(e)},a.prototype.addVariable=function(e,t,r){this.varData.addVariable(e,t,r)},a.prototype.unload=function(){},a.prototype.clone=function(e,t){var r=new a(this._projectName,this._templateID);return r._objectID=e,r._templateVarID=t,r.dataSource=this.dataSource,r.varData=this.varData,r._instanceCount=this._instanceCount,r},a.prototype.clear=function(){this.dataSource&&this.dataSource.clear(),this.varData&&this.varData.clear(),this.templateInstance&&this.templateInstance.clear()},a);function a(e,t){this._projectName="",this._templateID="",this._templateVarID="",this._objectID="",this.templateInstance=null,this._instanceCount=0,this._projectName=e,this._templateID=t,this.dataSource=new i.VE_DataSource(e,t,!0),this.varData=new i.VE_VariableData(e)}r.VE_Template=n},{"../dataSource":11}],66:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=e("./template"),i=(Object.defineProperty(n.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),n.prototype.isCreatedTemplate=function(e){return!!this._templateDic[e]},n.prototype.addTemplate=function(e,t){this._templateDic[e]=t},n.prototype.getTemplate=function(e){return this._templateDic[e]},n.prototype.isCreatedInstance=function(e,t){return!(!this._instanceDic[e]||!this._instanceDic[e][t])},n.prototype.getInstance=function(e,t){return this._instanceDic[e][t]},n.prototype.clear=function(){var t=this;this._templateDic&&(Object.keys(this._templateDic).forEach(function(e){t._templateDic[e].clear()}),this._templateDic={})},n.prototype.createInstance=function(e,t,r,i,n,a){return new o.VE_Template(this._projectName,t)},n);function n(e){this._projectName="",this._templateDic={},this._instanceDic={},this._projectName=e}r.VE_Templates=i},{"./template":65}],67:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./triggerBehaviour")),i(e("./triggers"))},{"./triggerBehaviour":68,"./triggers":69}],68:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../state/stateConst"),n=(Object.defineProperty(a.prototype,"enabled",{get:function(){return this._enabled},set:function(e){this._enabled=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isEnabled",{get:function(){if(this._logicalSwitch)for(var e=0;e<this._logicalSwitch.length;e++)if(!this._logicalSwitch[e].evaluate())return!1;return!0},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"objectID",{get:function(){return this._objectID},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"triggerID",{get:function(){return this._triggerID},enumerable:!0,configurable:!0}),a.prototype.call=function(){console.log(this._objectID)},a.prototype.set=function(e){this.scene=e},a.prototype.setTriggerID=function(e,t){this._triggerID=e,this._objectID=t,this._id=t+i.StateConst.STATE_SEPARATOR+e},a.prototype.addLogicalSwitch=function(e){this._logicalSwitch.push(e)},a.prototype.addTriggerTarget=function(e,t){this._logicalExp.push(e),this._triggerTargets.push(t)},a.prototype.sendEvent=function(){this.isEnabled&&this.eventProcess()},a.prototype.eventProcess=function(){if(this._triggerTargets)for(var e=0;e<this._triggerTargets.length;e++)this._logicalExp[e].evaluate()&&this._triggerTargets[e].action(this._id)},a.prototype.paraParser=function(e){return!0},a.prototype.update=function(){this.isEnabled&&this.onUpdate()},a.prototype.onUpdate=function(){},a);function a(){this._enabled=!0,this._projectName="",this._logicalSwitch=[],this._logicalExp=[],this._triggerTargets=[],this._objectID="object-axxx",this._triggerID="",this._id=""}r.VE_TriggerBehaviour=n},{"../state/stateConst":63}],69:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../html"),s=e("../state"),u=e("../manager"),i=(a.addTrigger=function(e){for(var t=e.ID.split("|"),r=0;r<t.length;r++){var i=t[r].trim().toLowerCase();this._triggerDics[i]?n.ShowError.showError("触发初始化错误，触发ID重复，当前触发ID："+i+"，请为当前触发重新分配触发ID！"):this._triggerDics[i]=e}},a.hasTrigger=function(e){return e=e.toLowerCase(),!!this._triggerDics[e]},a.createTrigger=function(e){return e=e.toLowerCase(),Object.create(this._triggerDics[e])},a.remove=function(e){e=e.toLowerCase(),delete this._triggerDics[e]},a.findTrigger=function(e,t){if(e.isCreatedTrigger(t))return e.getTrigger(t);var r=t.split(s.StateConst.STATE_SEPARATOR);if(2!==r.length)return null;var i=u.VE_Manager.objects(e.projectName),n=r[0].trim(),a=r[1].trim();if(i.isCreated(n)){var o=i.getVeryObject(n);return o.isCreatedTrigger(a)?o.getTrigger(a):null}return null},a._triggerDics={},a);function a(){}r.VE_Triggers=i},{"../html":39,"../manager":49,"../state":60}],70:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.remove=function(e,t){var r=e.indexOf(t);-1<r&&e.splice(r,1)},n.clear=function(e){},n);function n(){}r.ArrayUtility=i},{}],71:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n.prototype,"count",{get:function(){return this.Count()},enumerable:!0,configurable:!0}),n.prototype.Add=function(e,t){return this._keys.push(e),this._values.push(t)},n.prototype.Remove=function(e){var t=this._keys.indexOf(e,0);this._keys.splice(t,1),this._values.splice(t,1)},n.prototype.Count=function(){return this._keys.length},n.prototype.SetValue=function(e,t){var r=this._keys.indexOf(e,0);return-1!=r&&(this._keys[r]=e,this._values[r]=t,!0)},n.prototype.GetValue=function(e){var t=this._keys.indexOf(e,0);return-1!=t?this._values[t]:null},n.prototype.ContainsKey=function(e){for(var t=this._keys,r=0;r<t.length;++r)if(t[r]==e)return!0;return!1},n.prototype.GetKeys=function(){return this._keys},n.prototype.GetValues=function(){return this._values},n);function n(){this._keys=[],this._values=[]}r.Dictionary=i},{}],72:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.prototype.clear=function(){this.isRight=!0,this.message=""},n);function n(){this.isRight=!0,this.message=""}r.ErrorInfo=i},{}],73:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./arrayUtility")),i(e("./dictionary")),i(e("./errorInfo")),i(e("./stringFormat"))},{"./arrayUtility":70,"./dictionary":71,"./errorInfo":72,"./stringFormat":74}],74:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.init=function(){this._escapeCharacters.n="\n",this._escapeCharacters.b="\b",this._escapeCharacters.r="\r",this._escapeCharacters.t="\t",this._escapeCharacters.v="\v",this._escapeCharacters.f="\f",this._escapeCharacters[0]="\0",this._illegalChar["="]=!0,this._illegalChar[","]=!0,this._illegalChar["，"]=!0,this._illegalChar[":"]=!0,this._illegalChar["："]=!0,this._illegalChar["*"]=!0,this._illegalChar["("]=!0,this._illegalChar["（"]=!0,this._illegalChar[")"]=!0,this._illegalChar["）"]=!0,this._illegalChar["@"]=!0,this._illegalChar["#"]=!0,this._illegalChar.$=!0,this._illegalChar["%"]=!0,this._illegalChar["&"]=!0,this._illegalChar["^"]=!0,this._illegalChar["-"]=!0,this._illegalChar["+"]=!0,this._illegalChar["|"]=!0,this._illegalChar["/"]=!0,this._illegalChar["["]=!0,this._illegalChar["【"]=!0,this._illegalChar["]"]=!0,this._illegalChar["】"]=!0,this._illegalChar["{"]=!0,this._illegalChar["}"]=!0,this._illegalChar["."]=!0,this._illegalChar["。"]=!0,this._illegalChar["<"]=!0,this._illegalChar[">"]=!0,this._illegalChar[";"]=!0,this._illegalChar["；"]=!0,this._illegalChar["?"]=!0,this._illegalChar['"']=!0,this._illegalChar["“"]=!0,this._illegalChar["”"]=!0,this._illegalChar["'"]=!0,this._illegalChar["‘"]=!0,this._illegalChar["’"]=!0,this._illegalChar["!"]=!0,this._illegalChar["！"]=!0,this._illegalChar["`"]=!0,this._illegalChar["·"]=!0,this._illegalChar["~"]=!0,this._formulaChar["("]=!0,this._formulaChar[")"]=!0,this._formulaChar["（"]=!0,this._formulaChar["）"]=!0,this._formulaChar["!"]=!0,this._formulaChar["！"]=!0,this._formulaChar["^"]=!0,this._formulaChar["%"]=!0,this._formulaChar["&"]=!0,this._formulaChar["-"]=!0,this._formulaChar["+"]=!0,this._formulaChar["="]=!0,this._formulaChar["<"]=!0,this._formulaChar[">"]=!0,this._formulaChar["|"]=!0},n.strEscapeCharacterAction=function(e){for(var t="",r=0;r<e.length;r++)"\\"==e[r]&&r!=e.length-1?(t+=this.getEscapeCharacter(e[r+1]),r++):t+=e[r];return t},n.strSubsectionAction=function(e){for(var t="",r=[],i=!1,n=!1,a=0;a<e.length;a++){if("\\"==e[a]){if(a<e.length-1){t+=e[a+1],a++;continue}t+=e[a];break}if(n||'"'!==e[a]&&"“"!==e[a])if(!n||'"'!==e[a]&&"”"!==e[a])if(","===e[a]||"，"===e[a])i?t+=e[a]:(""!==t&&r.push(t),t="");else{if(" "===e[a])continue;t+=e[a]}else n=i=!1,""!=(t+='"')&&r.push(t),t="";else i=n=!0,t+='"'}return""!==t&&r.push(t),r},n.getEscapeCharacter=function(e){return this._escapeCharacters[e]?this._escapeCharacters[e]:e},n.getEscapeCharacter2=function(e,t){return this._escapeCharacters[e]?(t[0]=!0,this._escapeCharacters[e]):(t[0]=!1,e)},n.strSubsection=function(e){for(var t="",r=[],i=!1,n=!1,a=0;a<e.length;a++){if("\\"==e[a]){if(a<e.length-1){t+=this.getEscapeCharacter(e[a+1]),a++;continue}t+=e[a];break}if("("===e[a]||"（"===e[a]||'"'===e[a]||"“"===e[a])n=!(i=!0);else if(")"===e[a]||"）"===e[a]||'"'===e[a]||"”"===e[a])i=!1,""!==t&&r.push(t),t="",n=!1;else if(","===e[a]||"，"===e[a])i?t+=e[a]:(""!==t&&r.push(t),t=""),n=!1;else{if(" "===e[a]&&!n)continue;t+=e[a],n=!0}}return""!==t&&r.push(t),r},n.getParaArrayAll=function(e,t){for(var r=t.slice(),i=0;i<r.length;i++)if(r[i].startsWith("$"))if(-1<r[i].indexOf(",")||r[i].indexOf("，")){var n=r[i].split(/,|，/);n=this.getParaArrayAll(e,n);for(var a="",o=0;o<n.length;o++)o===n.length-1?a+=n[o]:(a+=n[o],a+=",");r[i]=a}else console.log("变量名："+r[i]+"，该变量未被创建！");else if(r[i].startsWith("%"))if(-1<r[i].indexOf(",")||-1<r[i].indexOf("，")){for(n=r[i].split(/,|，/),n=this.getParaArrayAll(e,n),a="",o=0;o<n.length;o++)o==n.length-1?a+=n[o]:(a+=n[o],a+=",");r[i]=a}else console.log("变量名："+r[i]+"，该BlurVar变量未被创建！");else if(-1<r[i].indexOf(",")||-1<r[i].indexOf("，")){for(n=r[i].split(/,|，/),n=this.getParaArrayAll(e,n),a="",o=0;o<n.length;o++)o==n.length-1?a+=n[o]:(a+=n[o],a+=",");r[i]=a}return r},n.paraSegment=function(e){for(var t="",r=[],i=!1,n=0,a=!1,o=!1,s=0;s<e.length;s++){if("\\"==e[s]){if(s<e.length-1){var u=[!0],p=this.getEscapeCharacter2(e[s+1],u);u[0]?(s++,t+=p):t+=e[++s];continue}t+=e[s];break}"("===e[s]||"（"===e[s]?o?t+=e[s]:(i?(n++,t+=e[s]):""!==t.trim()?(t+=e[s],a=!0):s<e.length-1&&this.needSaveBracket(e.substring(s+1))&&(t+=e[s],a=!0),i=!0):")"===e[s]||"）"===e[s]?o?t+=e[s]:0<n?(n--,i=!0,t+=e[s]):i=!(!i||!a)&&(t+=e[s],a=!1):'"'===e[s]?(t+=e[s],o=!o):","===e[s]||"，"===e[s]?o?t+=e[s]:i?t+=e[s]:(""!==t&&r.push(t.trim()),t=""):t+=e[s]}return""!==t&&r.push(t.trim()),r},n.needSaveBracket=function(e){for(var t=!1,r=0,i=0;i<e.length;i++){if(t){if(" "===e[i])continue;return","!==e[i]&&"，"!==e[i]}"("===e[i]||"（"===e[i]?r++:")"!==e[i]&&"）"!==e[i]||(0<r?r--:t=!0)}return!1},n.isIDLegal=function(e){for(var t=0;t<e.length;t++)if(this._illegalChar[e[t]])return!1;return!0},n.isFormulaString=function(e){for(var t=0;t<e.length;t++)if(this._formulaChar[e[t]])return!0;return!1},n._illegalChar={},n._formulaChar={},n._escapeCharacters={},n);function n(){}(r.VE_StringFormat=i).init()},{}],75:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(n.boolConvert=function(e,t){return"true"===(e=e.toLowerCase().trim())||"开"===e||("false"===e||"关"===e||(t.isRight=!1,t.message="bool|开关类型转换错误，格式不正确，原始字符串："+e),!1)},n.intConvert=function(e,t){e=e.toLowerCase().trim();var r=parseFloat(e);return isNaN(r)?(t.isRight=!1,t.message="number|数字类型转化错误，格式不正确，原始字符串："+e,-1):Math.round(r)},n.floatConvert=function(e,t){e=e.toLowerCase().trim();var r=parseFloat(e);return isNaN(r)?(t.isRight=!1,t.message="number|数字类型转化错误，格式不正确，原始字符串："+e,-1):r},n);function n(){}r.VE_TypeConvert=i},{}],76:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n.prototype,"gameObject",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"transform",{get:function(){return this._transform},enumerable:!0,configurable:!0}),n.find=function(e){return new n(e)},n);function n(e){this._transform=new a,this.mesh=null,this.name=e}r.GameObject=i;var a=(Object.defineProperty(o.prototype,"childCount",{get:function(){return 0},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"hierarchyCount",{get:function(){return 0},enumerable:!0,configurable:!0}),o);function o(){this._transformNode=null,this._mesh=null,this.localPosition=BABYLON.Vector3.Zero(),this.position=BABYLON.Vector3.Zero(),this.localEulerAngles=BABYLON.Vector3.Zero(),this.eulerAngles=BABYLON.Vector3.Zero(),this.forward=BABYLON.Vector3.Forward(),this.localScale=new BABYLON.Vector3(1,1,1)}r.Transform=a},{}],77:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./veryVarManager")),i(e("./veryVariables")),i(e("./babylonVariables")),i(e("./variables"))},{"./babylonVariables":76,"./variables":78,"./veryVarManager":79,"./veryVariables":80}],78:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../dataSource"),n=(Object.defineProperty(a.prototype,"projectName",{get:function(){return this._projectName},enumerable:!0,configurable:!0}),a.prototype.isCreated=function(e){return!!(this._veryVars[e]||this._tempalteVars[e]||this._expressions[e])},a.prototype.isCreatedVariable=function(e){return!!this._veryVars[e]},a.prototype.addVariable=function(e,t){this._veryVars[e]=t},a.prototype.getVariable=function(e){return this._veryVars[e]},a.prototype.isCreatedTemplate=function(e){return!!this._tempalteVars[e]},a.prototype.addTemplate=function(e,t){this._tempalteVars[e]=t},a.prototype.getTemplate=function(e){return this._tempalteVars[e]},a.prototype.isCreatedExpression=function(e){return!!this._expressions[e]},a.prototype.addExpression=function(e,t){this._expressions[e]=t},a.prototype.getExpression=function(e){return this._expressions[e]},a.prototype.clear=function(){this.varData&&this.varData.clear(),this._veryVars={},this._expressions={},this._tempalteVars={}},a);function a(e){this._projectName="",this._veryVars={},this._tempalteVars={},this._expressions={},this._projectName=e,this.varData=new i.VE_VariableData(e)}r.VE_Variables=n},{"../dataSource":11}],79:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("../html/showError"),p=e("../manager"),c=e("./veryVariables"),n=(a.hasVarType=function(e){return e=e.toLowerCase(),!!this._veryVarTypes[e]},a.addVarType=function(e,t){e=e.toLowerCase().trim(),this._veryVarTypes[e]?i.ShowError.showError("VeryVar变量初始化错误，变量类型重复，当前变量名："+e+"，当前变量类型："+t.className):this._veryVarTypes[e]=t},a.createVar=function(e){return e=e.toLowerCase(),Object.create(this.getVarType(e))},a.createVariable=function(e,t,r,i){var n;t=t.toLowerCase();try{if(!(n=Object.create(this.getVarType(t))))return i.isRight=!1,i.message="变量创建错误：当前类型在平台中不存在，请检查！类型名："+t,null;var a=n.initValue(r,i);return i.isRight?(n.setValue(a),n):null}catch(e){return console.log(e.message),i.isRight=!1,i.message="变量创建错误：当前类型在平台中不存在，请检查！类型名："+t+"，错误原因："+e.message,null}},a.getVarType=function(e){return e=e.toLowerCase(),this._veryVarTypes&&this._veryVarTypes[e]?this._veryVarTypes[e]:null},a.remove=function(e){e=e.toLowerCase(),delete this._veryVarTypes[e]},a.getVariable=function(e,t,r,i){if(""===t)return this.getSceneVariable(e,i);if(""===r)return this.getGlobalVariable(e,t,i);var n=p.VE_Manager.objects(t);if(n){var a=n.getVeryObject(r);return a?a.isCreatedVariable(e)?a.getVariable(e):a.isCreatedExpression(e)?new c.VeryExpression(a.getExpression(e)):a.isCreatedFsm(e)?a.getFsm(e).fsmVar:this.getGlobalVariable(e,t,i):this.getGlobalVariable(e,t,i)}return this.getGlobalVariable(e,t,i)},a.getTemplateVariable=function(e,t,r,i,n){if(""===r)return n.isRight=!1,n.message="无法在当前项目中查找到当前模板变量："+e+"；\n",null;if(""!==i){var a=p.VE_Manager.objects(r);if(a){if(a.isCreated(i)){var o=a.getVeryObject(i);return o.isCreatedTemplate(e)?null===(s=o.getTemplate(e)).templateInstance?(n.isRight=!1,n.message+="当前模板变量未实例化，请先实例化该模板对象，模板变量名："+e+"；\n",null):s.templateInstance.isCreatedVariable(t)?s.templateInstance.getVariable(t):s.templateInstance.isCreatedExpression(t)?new c.VeryExpression(s.templateInstance.getExpression(t)):s.templateInstance.isCreatedFsm(t)?s.templateInstance.getFsm(t).fsmVar:(n.isRight=!1,n.message+="当前模板变量中无法查找到该变量，模板变量名："+e+"，变量名："+t+"；\n",null):(n.isRight=!1,n.message+="无法在当前项目中查找到当前模板变量："+e+"；\n",null)}return n.isRight=!1,n.message+="无法在当前项目中查找到当前对象："+i+"；\n",null}return n.isRight=!1,n.message+="无法在当前项目中查找到当前对象："+i+"；\n",null}var s,u=p.VE_Manager.variables(r);return u&&u.isCreatedTemplate(e)?null===(s=u.getTemplate(e)).templateInstance?(n.isRight=!1,n.message+="当前模板变量未实例化，请先实例化该模板对象，模板变量名："+e+"；\n",null):s.templateInstance.isCreatedVariable(t)?s.templateInstance.getVariable(t):s.templateInstance.isCreatedExpression(t)?new c.VeryExpression(s.templateInstance.getExpression(t)):s.templateInstance.isCreatedFsm(t)?s.templateInstance.getFsm(t).fsmVar:(n.isRight=!1,n.message+="当前模板变量中无法查找到该变量，模板变量名："+e+"，变量名："+t+"；\n",null):(n.isRight=!1,n.message+="无法在当前项目中查找到当前模板变量："+e+"；\n",null)},a.getGlobalVariable=function(e,t,r){if(""===t)return this.getSceneVariable(e,r);var i=p.VE_Manager.variables(t);return i?i.isCreatedVariable(e)?i.getVariable(e):i.isCreatedExpression(e)?new c.VeryExpression(i.getExpression(e)):this.getSceneVariable(e,r):this.getSceneVariable(e,r)},a.getSceneVariable=function(e,t){return t.isRight=!1,t.message="暂时不支持场景变量！",null},a._veryVarTypes={},a);function a(){}r.VeryVarManager=n},{"../html/showError":40,"../manager":49,"./veryVariables":80}],80:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=e("./veryVarManager"),n=e("../expression"),a=(Object.defineProperty(o.prototype,"varType",{get:function(){return"bool|开关"},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"className",{get:function(){return"VeryBool"},enumerable:!0,configurable:!0}),Object.defineProperty(o.prototype,"Value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),o.prototype.setValue=function(e){this._value=e},o.prototype.getValue=function(){return this._value},o.prototype.initValue=function(e,t){return"false"!==(e=e.trim()).toLowerCase()&&"关"!==e&&("true"===e.toLowerCase()||"开"===e||""!==e&&"null"!==e.toLowerCase()&&"none"!==e.toLowerCase()&&(t.isRight=!1,t.message="类型: "+this.varType+"，值："+e+"，该变量值和类型不匹配，转化错误，请检查！",null))},o.prototype.clone=function(){var e=new o;return e.setValue(this._value),e},o);function o(){this._value=!1,this._value=!1}r.VeryBool=a;var s=(Object.defineProperty(u.prototype,"varType",{get:function(){return"int|整数"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"className",{get:function(){return"VeryInt"},enumerable:!0,configurable:!0}),Object.defineProperty(u.prototype,"Value",{get:function(){return Math.round(this._value)},set:function(e){this._value=Math.round(e)},enumerable:!0,configurable:!0}),u.prototype.getValue=function(){return this.Value},u.prototype.setValue=function(e){this.Value=e},u.prototype.initValue=function(e,t){var r=parseFloat(e);return isNaN(r)?(t.isRight=!1,t.message="类型: "+this.varType+"，值："+e+"，该变量值和类型不匹配，转化错误，请检查！",null):Math.round(r)},u.prototype.clone=function(){var e=new u;return e.setValue(this._value),e},u);function u(){this._value=0,this._value=0}r.VeryInt=s;var p=(Object.defineProperty(c.prototype,"varType",{get:function(){return"float|浮点数"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"className",{get:function(){return"VeryFloat"},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"Value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),c.prototype.setValue=function(e){this._value=e},c.prototype.getValue=function(){return this._value},c.prototype.initValue=function(e,t){var r=parseFloat(e);return isNaN(r)?(t.isRight=!1,t.message="类型: "+this.varType+"，值："+e+"，该变量值和类型不匹配，转化错误，请检查！",null):r},c.prototype.clone=function(){var e=new c;return e.setValue(this._value),e},c);function c(){this._value=0,this._value=0}r.VeryFloat=p;var l=(Object.defineProperty(h.prototype,"varType",{get:function(){return"number|数字"},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"className",{get:function(){return"VeryNumber"},enumerable:!0,configurable:!0}),Object.defineProperty(h.prototype,"Value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),h.prototype.setValue=function(e){this._value=e},h.prototype.getValue=function(){return this._value},h.prototype.initValue=function(e,t){var r=parseFloat(e);return isNaN(r)?(t.isRight=!1,t.message="类型: "+this.varType+"，值："+e+"，该变量值和类型不匹配，转化错误，请检查！",null):r},h.prototype.clone=function(){var e=new h;return e.setValue(this._value),e},h);function h(){this._value=0,this._value=0}r.VeryNumber=l;var _=(Object.defineProperty(f.prototype,"varType",{get:function(){return"string|字符串"},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"className",{get:function(){return"VeryString"},enumerable:!0,configurable:!0}),Object.defineProperty(f.prototype,"Value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),f.prototype.getValue=function(){return this._value},f.prototype.setValue=function(e){this._value=e},f.prototype.initValue=function(e,t){return e.startsWith("'")||e.startsWith('"')||e.startsWith("“")||e.startsWith("‘")?e.substring(1,e.length-2):e},f.prototype.clone=function(){var e=new f;return e.setValue(this._value),e},f);function f(){this._value="",this._value=""}r.VeryString=_;var g=(Object.defineProperty(d.prototype,"varType",{get:function(){return"vector3|向量"},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"className",{get:function(){return"VeryVector3"},enumerable:!0,configurable:!0}),Object.defineProperty(d.prototype,"Value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),d.prototype.getValue=function(){return this._value},d.prototype.setValue=function(e){this._value=e},d.prototype.initValue=function(e,t){var r=BABYLON.Vector3.Zero();if("none"===e||"null"===e||""===e)return r;var i=e.split(/,|，/);if(3!==i.length)return t.isRight=!1,t.message="类型: "+this.varType+", 值: "+e+"，Vector3|向量类型值格式错误，转化错误！",null;var n=parseFloat(i[0]),a=parseFloat(i[1]),o=parseFloat(i[2]);return isNaN(n)||isNaN(a)||isNaN(o)?(t.isRight=!1,t.message="类型: "+this.varType+", 值: "+e+"，Vector3|向量类型值格式错误，转化错误！",null):r=new BABYLON.Vector3(n,a,o)},d.prototype.clone=function(){var e=new d,t=new BABYLON.Vector3(this._value.x,this._value.y,this._value.z);return e.setValue(t),e},d);function d(){this._value=BABYLON.Vector3.Zero(),this._value=BABYLON.Vector3.Zero()}r.VeryVector3=g;var y=(Object.defineProperty(m.prototype,"varType",{get:function(){return this._value.expType},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"className",{get:function(){return"VeryExpression"},enumerable:!0,configurable:!0}),Object.defineProperty(m.prototype,"Value",{get:function(){return this._value},set:function(e){this._value=e},enumerable:!0,configurable:!0}),m.prototype.setValue=function(e){this._value=e},m.prototype.getValue=function(){return this._value},m.prototype.initValue=function(e,t){var r=parseFloat(e);return isNaN(r)?(t.isRight=!1,t.message="类型: "+this.varType+"，值："+e+"，该变量值和类型不匹配，转化错误，请检查！",null):r},m.prototype.clone=function(){return new m(this._value)},m);function m(e){this._value=n.ConstantExpression.Empty(),this._value=e}r.VeryExpression=y,i.VeryVarManager.addVarType("bool",new a),i.VeryVarManager.addVarType("开关",new a),console.log("XXX")},{"../expression":26,"./veryVarManager":79}],81:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("../verytable/index"),i=e("./html/showError"),a=e("./loader/loaderManager"),o=e("./variables"),s=e("./global");!function(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}(e("./index"));var u=(p.prototype.init=function(e,t){var r=new n.VeryTable(e,"VeRyEngine");console.log("开始"),o.VeryVarManager.addVarType("bool",new o.VeryBool);var i=(new a.LoaderManager).load(projectName,r);console.log(i),i||s.VE_ErrorManager.print()},p.prototype.showErrorTest=function(e){i.ShowError.show("大股东萨芬个是电饭锅三分隔收费的发大股东萨芬个是电饭锅三分隔收费的发大股东萨芬个是电饭锅三分隔收费的发大股东萨芬个是电饭锅三分隔收费的发大股东萨芬个是电饭锅三分隔收费的发大股东萨芬个是电饭锅三分隔收费的发，错误位置："+e.pos(7,5)),i.ShowError.showError("大股东萨芬个是电饭锅三分隔收费的发，错误位置："+e.pos(7,5)),i.ShowError.showWarn("大股东萨芬个是电饭锅三分隔收费的发，错误位置："+e.pos(7,5)),i.ShowError.show("大股东萨芬个是电饭锅三分隔收费的发，错误位置："+e.pos(7,5)),i.ShowError.show("大股东萨芬个是电饭锅三分隔收费的发，错误位置："+e.pos(7,5)),document.getElementById("settingsButton").addEventListener("click",i.ShowError.close)},p);function p(){}r.VeryEngine=u},{"../verytable/index":82,"./global":37,"./html/showError":40,"./index":41,"./loader/loaderManager":48,"./variables":77}],82:[function(e,t,r){"use strict";function i(e){for(var t in e)r.hasOwnProperty(t)||(r[t]=e[t])}Object.defineProperty(r,"__esModule",{value:!0}),i(e("./veryTableRow")),i(e("./veryTable")),i(e("./veryTableSet"))},{"./veryTable":83,"./veryTableRow":84,"./veryTableSet":85}],83:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var n=e("./veryTableRow"),i=(Object.defineProperty(a.prototype,"ID",{get:function(){return this._id},set:function(e){this._id=e},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"RowCount",{get:function(){return this._rows?this._rows.length:0},enumerable:!0,configurable:!0}),a.prototype.getData=function(e,t){return this._rows[e].getData(t)},a.prototype.getRow=function(e){return 0<=e&&e<this._rows.length?this._rows[e]:void 0},a.prototype.pos=function(e,t){return"（"+(e+1)+"，"+this.getColumnID(t)+"，表名："+this.ID+"）"},a.prototype.getColumnID=function(e){if(0<=e&&e<26)return this._columnIDs[e];if(e<0)return"error";var t=Math.floor(e/26),r=e%26;return 0===t?this._columnIDs[t]:this._columnIDs[t-1]+this._columnIDs[r]},a.prototype.addRow=function(e){this._rows.push(e)},a);function a(e,t){if(void 0===t&&(t="默认Sheet"),this._id="",this._columnIDs=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],this._rows=[],this._id=t,this._rows=[],e)for(var r=0;r<e.length;r++){var i=new n.VeryTableRow(e[r]);this._rows.push(i)}}r.VeryTable=i},{"./veryTableRow":84}],84:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n.prototype,"Count",{get:function(){return this._rowData?this._rowData.length:0},enumerable:!0,configurable:!0}),n.prototype.getData=function(e){return this._rowData[e]},n.prototype.add=function(e){this._rowData.push(e)},n.prototype.insert=function(e,t){this._rowData.push(t);var r=this._rowData.slice(e);r.push(t),this._rowData=r},n.prototype.remove=function(e){this._rowData.splice(e,1)},n.prototype.removeEnd=function(){this._rowData.pop()},n.prototype.isEmpty=function(){if(!this._rowData)return!0;for(var e=0;e<this._rowData.length;e++)if(""!==this._rowData[e])return!1;return!0},n);function n(e){this._rowData=[],this._rowData=e}r.VeryTableRow=i},{}],85:[function(e,t,r){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var i=(Object.defineProperty(n.prototype,"Count",{get:function(){return this._tables?this._tables.length:0},enumerable:!0,configurable:!0}),n.prototype.getTable=function(e){return 0<=e&&e<this.Count?this._tables[e]:void 0},n.prototype.addTable=function(e){this._tables.push(e)},n.prototype.removeTable=function(e){0<=e&&e<this.Count&&this._tables.splice(e,1)},n);function n(e){this._tables=[],e&&(this._tables=e)}r.VeryTableSet=i},{}]},{},[2]);
//# sourceMappingURL=veryengine.js.map
